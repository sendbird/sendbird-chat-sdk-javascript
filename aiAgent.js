import{c as t,A as e,bu as n,e as i,f as r,g as s,a,a1 as o,j as l,bA as u,a4 as h,_ as c,b as d,V as g,aa as p,u as f,aq as v,aW as _,t as C,b7 as m,F as A}from"./lib/__bundle-80d8a4fc.js";export{bB as AIAgentInfo}from"./lib/__bundle-80d8a4fc.js";import{I as k,b as y,J as b,K as U,L as F}from"./lib/__bundle-79544c38.js";export{I as Conversation,W as ConversationChannelInfo,R as ConversationHandoff,V as ConversationResolution,L as ConversationStatus,N as ConversationType}from"./lib/__bundle-79544c38.js";import"./lib/__bundle-fbbc1166.js";import"./lib/__bundle-dd5fd7f0.js";import"./lib/__bundle-d1d2f687.js";import"./lib/__bundle-acd77193.js";var w,E,S=function(r){function s(t){var s=t.aiAgentId,a=t.userId,o=t.language,l=t.country,u=t.context,h=t.forceCreateChannel,c=t.knownActiveChannelUrl,d=r.call(this)||this;return d.method=e.POST,d.path="".concat(n,"/ai_agents/").concat(encodeURIComponent(s),"/messenger_settings"),d.requireAuth=!1,d.params=i({user_id:a,country:l,language:o,context:u,force_create:h,known_active_channel_url:c}),d}return t(s,r),s}(r),M=function(e){function n(t,n){var i=e.call(this,t,n)||this;return i.settings=n,i}return t(n,e),n}(s),T=function(r){function s(t){var s=this,a=t.token,o=t.limit,l=t.aiAgentId,u=t.status,h=t.reverse,c=t.order;return(s=r.call(this)||this).method=e.GET,s.path="".concat(n,"/my_conversations"),s.params=i({token:a,limit:o,reverse:h,order:c,status:u,bot_userid:l}),s}return t(s,r),s}(r),x=function(e){function n(t,n){var i=e.call(this,t,n)||this;i.conversations=[];var r=n.next_token,s=n.conversations;return i.token=r,s&&s.length>0&&(i.conversations=s.map((function(t){return new k(t)}))),i}return t(n,e),n}(s),D={limit:10},q=function(r){function s(t){var s=this,a=t.limit,o=void 0===a?D.limit:a,l=t.keys,u=t.token;return(s=r.call(this)||this).method=e.GET,s.path="".concat(n,"/sdk_message_templates"),s.params=i({limit:o,keys:l,token:u}),s}return t(s,r),s}(r),G=function(e){function n(t,n){var i=e.call(this,t,n)||this,r=n.templates,s=n.template_list_token;return i.token=s,i.templates=r.map((function(t){return{template:JSON.stringify(t)}})),i}return t(n,e),n}(s),Q=function(i){function r(t){var r=this,s=t.key;return(r=i.call(this)||this).method=e.GET,r.path="".concat(n,"/sdk_message_templates/").concat(s),r}return t(r,i),r}(r),P=function(e){function n(t,n){var i=e.call(this,t,n)||this;return i.template=JSON.stringify(n),i}return t(n,e),n}(s);!function(t){t.INCLUDE="include",t.EXCLUDE="exclude"}(w||(w={})),function(t){t.INCLUDE="include",t.EXCLUDE="exclude"}(E||(E={}));var j,O={aiAgentChannelFilter:w.INCLUDE,aiAgentIds:[],deskChannelFilter:E.INCLUDE,pinnedChannelUrls:[]},H=function(n){function r(t){var r=n.call(this)||this,s=l(l({},O),t),a=s.aiAgentChannelFilter,o=s.aiAgentIds,h=s.deskChannelFilter,c=s.aiAgentConversationStatusFilter,d=s.pinnedChannelUrls,g=s.userId,p=s.token,f=s.limit;return r.method=e.GET,r.path="".concat(u,"/").concat(encodeURIComponent(g),"/my_group_channels"),r.params=i({token:p,limit:f,ai_agent_channel_filter:a,desk_channel_filter:h}),c&&c.length>0&&(r.params.ai_agent_conversation_status_filter=c),o&&o.length>0&&(r.params.ai_agent_ids=o),d&&d.length>0&&(r.params.pinned_channel_urls=d),r}return t(r,n),r}(r),X=function(e){function n(t,n){var i=e.call(this,t,n)||this;i.channels=[];var r=n.next,s=n.channels,a=n.ts;return i.token=r,s&&s.length>0&&(i.channels=s.map((function(e){return e.ts=a,new y(t,e)}))),i.ts=null!=a?a:0,i}return t(n,e),n}(s),B={aiAgentChannelFilter:w.INCLUDE,aiAgentIds:[],deskChannelFilter:E.INCLUDE,pinnedChannelUrls:[]},J=function(t){return h(w,t.aiAgentChannelFilter,!0)&&o("string",t.aiAgentIds,!0)&&h(E,t.deskChannelFilter,!0)&&o("string",t.pinnedChannelUrls,!0)},z=function(n){function r(t){var r=t.userId,s=t.ts,a=t.token,o=t.params,h=n.call(this)||this,c=l(l({},B),o),d=c.aiAgentChannelFilter,g=c.aiAgentIds,p=c.deskChannelFilter,f=c.pinnedChannelUrls;return h.method=e.GET,h.path="".concat(u,"/").concat(encodeURIComponent(r),"/my_group_channels/changelogs"),h.params=i({token:a,change_ts:s,ai_agent_channel_filter:d,desk_channel_filter:p}),g&&g.length>0&&(h.params.ai_agent_ids=g),f&&f.length>0&&(h.params.pinned_channel_urls=f),h}return t(r,n),r}(r),K=function(e){function n(t,n){var i=e.call(this,t,n)||this;return i.updatedChannels=n.updated.map((function(e){var i=Object.assign(e,{ts:n.ts});return new y(t,i)})),i.deletedChannelUrls=n.deleted,i.hasMore=n.has_more,i.token=n.next,i.ts=n.ts,i}return t(n,e),n}(s),Y={aiAgentChannelFilter:w.INCLUDE,aiAgentIds:[],deskChannelFilter:E.INCLUDE,pinnedChannelUrls:[]},Z=function(n){function r(t){var r=t.userId,s=t.params,a=n.call(this)||this,o=l(l({},Y),s),h=o.aiAgentChannelFilter,c=o.aiAgentConversationStatusFilter,d=o.aiAgentIds,g=o.deskChannelFilter,p=o.pinnedChannelUrls;return a.method=e.GET,a.path="".concat(u,"/").concat(encodeURIComponent(r),"/my_group_channels/unread_message_count"),a.params=i({ai_agent_channel_filter:h,desk_channel_filter:g}),c&&c.length>0&&(a.params.ai_agent_conversation_status_filter=c),d&&d.length>0&&(a.params.ai_agent_ids=d),p&&p.length>0&&(a.params.pinned_channel_urls=p),a}return t(r,n),r}(r),$=function(e){function n(t,n){var i=e.call(this,t,n)||this;return i.total=n.total,i.aiAgentChannelCount=n.ai_agent_channel,i.deskChannelCount=n.desk_channel,i.pinnedChannel=n.pinned_channel.map((function(t){return{channelUrl:t.channel_url,count:t.count}})),i}return t(n,e),n}(s),tt={},et=function(){function t(t,e){var n=e.sdkState,i=e.requestQueue,r=e.logger,s=e.dispatcher;this._iid=t,this._sdkState=n,this._requestQueue=i,this._logger=r,this._dispatcher=s,tt[t]=this}return t.of=function(t){return tt[t]},t.prototype.requestMessengerSettings=function(t){return c(this,void 0,void 0,(function(){var e,n,i;return d(this,(function(r){switch(r.label){case 0:return e=g.of(this._iid).requestQueue,n=new S(t),[4,e.commandRouter.send(n)];case 1:return i=r.sent(),[2,i.as(M).settings]}}))}))},t.prototype.getConversations=function(t,e,n){return c(this,void 0,void 0,(function(){var i,r,s,a,o,u;return d(this,(function(h){switch(h.label){case 0:return i=g.of(this._iid).requestQueue,r=new T(l(l({},e),{token:t,limit:n})),[4,i.send(r)];case 1:return s=h.sent(),a=s.as(x),o=a.conversations,u=a.token,[2,{conversations:o,token:u}]}}))}))},t.prototype.getMessageTemplates=function(t){return void 0===t&&(t={}),c(this,void 0,void 0,(function(){var e,n,i,r,s,a,o;return d(this,(function(l){switch(l.label){case 0:return e=t.keys,n=t.limit,i=new q({keys:e,limit:n}),[4,this._requestQueue.send(i)];case 1:return r=l.sent(),s=r.as(G),a=s.templates,o=s.token,[2,{templates:a,token:o}]}}))}))},t.prototype.getMessageTemplate=function(t){return c(this,void 0,void 0,(function(){var e,n;return d(this,(function(i){switch(i.label){case 0:return e=new Q({key:t}),[4,this._requestQueue.send(e)];case 1:return n=i.sent(),[2,{template:n.as(P).template}]}}))}))},t.prototype.getMyGroupChannels=function(t,e,n,i){return void 0===i&&(i=p.REQUEST_CHANNEL),c(this,void 0,void 0,(function(){var r,s,a,o,u,h;return d(this,(function(c){switch(c.label){case 0:return r=new H(l(l({},e),{userId:this._sdkState.userId,token:t,limit:n})),[4,this._requestQueue.send(r)];case 1:return s=c.sent(),a=s.as(X),o=a.channels,u=a.token,h=a.ts,this._dispatcher.dispatch(new b({channels:o,context:{source:i}})),[2,{channels:o,token:u,ts:h}]}}))}))},t.prototype.getMyGroupChannelChangeLogs=function(t,e,n){return void 0===n&&(n=p.REQUEST_CHANNEL_CHANGELOGS),c(this,void 0,void 0,(function(){var i,r,s,a,o,l,u,h,c;return d(this,(function(d){switch(d.label){case 0:return i="string"==typeof t?t:null,r="number"==typeof t?t:null,s=new z(f({userId:this._sdkState.userId,ts:r,token:i,params:e})),[4,this._requestQueue.send(s)];case 1:return a=d.sent(),o=a.as(K),l=o.updatedChannels,u=o.deletedChannelUrls,h=o.hasMore,c=o.ts,l.length>0&&this._dispatcher.dispatch(new b({channels:l,context:{source:n},ts:c})),u.length>0&&this._dispatcher.dispatch(new U({channelUrls:u,context:{source:n}})),[2,{updatedChannels:l,deletedChannelUrls:u,hasMore:h,token:o.token}]}}))}))},t.prototype.getUnreadMessageCount=function(t){return c(this,void 0,void 0,(function(){var e,n,i,r,s,a,o;return d(this,(function(l){switch(l.label){case 0:return e=new Z({userId:this._sdkState.userId,params:t}),[4,this._requestQueue.send(e)];case 1:return n=l.sent(),i=n.as($),r=i.total,s=i.aiAgentChannelCount,a=i.deskChannelCount,o=i.pinnedChannel,[2,{total:r,aiAgentChannelCount:s,deskChannelCount:a,pinnedChannel:o}]}}))}))},t}();!function(t){t.CREATED_AT="created_at",t.UPDATED_AT="updated_at"}(j||(j={}));var nt={status:void 0,aiAgentId:void 0,reverse:!1,order:j.UPDATED_AT},it=function(e){function n(t,n){var i,r,s,a,o=this;return(o=e.call(this,t,n)||this).status=null!==(i=n.status)&&void 0!==i?i:void 0,o.aiAgentId=null!==(r=n.aiAgentId)&&void 0!==r?r:void 0,o.reverse=null!==(s=n.reverse)&&void 0!==s?s:nt.reverse,o.order=null!==(a=n.order)&&void 0!==a?a:nt.order,o}return t(n,e),n.prototype._validate=function(){return e.prototype._validate.call(this)&&h(F,this.status,!0)&&a("string",this.aiAgentId,!0)&&a("boolean",this.reverse)&&h(j,this.order)},n.prototype.serialize=function(){return v(this)},n.prototype.next=function(){return c(this,void 0,void 0,(function(){var t,e,n,i;return d(this,(function(r){switch(r.label){case 0:return t=et.of(this._iid),this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,[4,t.getConversations(this._token,f(l({},this)),this.limit)]):[3,2]:[3,5];case 1:return e=r.sent(),n=e.conversations,i=e.token,this._token=i,this._hasNext=!!i,this._isLoading=!1,[2,n];case 2:return[2,[]];case 3:throw C.queryInProgress;case 4:return[3,6];case 5:throw C.invalidParameters;case 6:return[2]}}))}))},n}(_),rt=function(e){function n(t,n){var i=e.call(this,t,n)||this;return i._ts=0,i.aiAgentChannelFilter=O.aiAgentChannelFilter,i.aiAgentIds=O.aiAgentIds,i.deskChannelFilter=O.deskChannelFilter,i.pinnedChannelUrls=O.pinnedChannelUrls,n.aiAgentChannelFilter&&(i.aiAgentChannelFilter=n.aiAgentChannelFilter),n.aiAgentConversationStatusFilter&&(i.aiAgentConversationStatusFilter=n.aiAgentConversationStatusFilter),n.aiAgentIds&&(i.aiAgentIds=n.aiAgentIds),n.deskChannelFilter&&(i.deskChannelFilter=n.deskChannelFilter),n.pinnedChannelUrls&&(i.pinnedChannelUrls=n.pinnedChannelUrls),i}return t(n,e),n.prototype._validate=function(){return e.prototype._validate.call(this)&&h(w,this.aiAgentChannelFilter)&&o(F,this.aiAgentConversationStatusFilter,!0)&&o("string",this.aiAgentIds)&&h(E,this.deskChannelFilter)&&o("string",this.pinnedChannelUrls)},n.prototype.serialize=function(){return v(this)},Object.defineProperty(n.prototype,"lastResponseAt",{get:function(){return this._ts},enumerable:!1,configurable:!0}),n.prototype.belongsTo=function(t){if(this.pinnedChannelUrls.includes(t.url))return!0;if(t.isAIAgent&&!t.conversation)return!1;if(this.aiAgentChannelFilter===w.EXCLUDE)if(t.isAIAgent)return!1;if(this.aiAgentConversationStatusFilter&&t.isAIAgent&&!this.aiAgentConversationStatusFilter.some((function(e){var n;return(null===(n=t.conversation)||void 0===n?void 0:n.status)===e})))return!1;if(this.deskChannelFilter===E.EXCLUDE)if(t.isDesk)return!1;return!0},n.prototype.next=function(){return c(this,void 0,void 0,(function(){var t,e,n,i,r,s;return d(this,(function(a){switch(a.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,t=et.of(this._iid),e=f({aiAgentChannelFilter:this.aiAgentChannelFilter,aiAgentConversationStatusFilter:this.aiAgentConversationStatusFilter,aiAgentIds:this.aiAgentIds,deskChannelFilter:this.deskChannelFilter,pinnedChannelUrls:this.pinnedChannelUrls}),[4,t.getMyGroupChannels(this._token,e,this.limit)]):[3,2]:[3,5];case 1:return n=a.sent(),i=n.channels,r=n.token,s=n.ts,this._token=r,this._hasNext=!!r,this._isLoading=!1,this._ts=s,[2,i];case 2:return[2,[]];case 3:throw C.queryInProgress;case 4:return[3,6];case 5:throw C.invalidParameters;case 6:return[2]}}))}))},n}(_),st=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.name="aiAgent",t}return t(n,e),n.prototype.init=function(t,n){var i=n.sdkState,r=n.dispatcher,s=n.sessionManager,a=n.requestQueue,o=n.logger,l=n.onlineDetector,u=n.cacheContext;e.prototype.init.call(this,t,{sdkState:i,dispatcher:r,sessionManager:s,requestQueue:a,logger:o,onlineDetector:l,cacheContext:u}),this._manager=new et(t,{sdkState:i,requestQueue:a,logger:o,dispatcher:r})},n.prototype.requestMessengerSettings=function(t){return c(this,void 0,void 0,(function(){var e,n,i,r,s,o,l;return d(this,(function(u){return e=t.aiAgentId,n=t.userId,i=t.language,r=t.country,s=t.context,o=t.forceCreateChannel,l=t.knownActiveChannelUrl,A(a("string",e)&&a("string",n,!0)&&a("string",i,!0)&&a("string",r,!0)&&a("object",s,!0)&&a("boolean",o,!0)&&a("string",l,!0)).throw(C.invalidParameters),[2,this._manager.requestMessengerSettings(t)]}))}))},n.prototype.createConversationListQuery=function(t){return void 0===t&&(t={}),new it(this._iid,t)},n.prototype.createMyGroupChannelListQuery=function(t){return void 0===t&&(t={}),new rt(this._iid,t)},n.prototype.getMyGroupChannelChangeLogsByToken=function(t,e){return void 0===e&&(e={}),c(this,void 0,void 0,(function(){var n;return d(this,(function(i){switch(i.label){case 0:return n=l(l({},B),e),A(a("string",t)&&J(n)).throw(C.invalidParameters),[4,this._manager.getMyGroupChannelChangeLogs(t,n)];case 1:return[2,i.sent()]}}))}))},n.prototype.getMyGroupChannelChangeLogsByTimestamp=function(t,e){return void 0===e&&(e={}),c(this,void 0,void 0,(function(){var n;return d(this,(function(i){switch(i.label){case 0:return n=l(l({},B),e),A(a("number",t)&&J(n)).throw(C.invalidParameters),[4,this._manager.getMyGroupChannelChangeLogs(t,n)];case 1:return[2,i.sent()]}}))}))},n.prototype.getUnreadMessageCount=function(t){return void 0===t&&(t={}),c(this,void 0,void 0,(function(){var e;return d(this,(function(n){return e=l(l({},Y),t),A(h(w,e.aiAgentChannelFilter,!0)&&o(F,e.aiAgentConversationStatusFilter,!0)&&o("string",e.aiAgentIds,!0)&&h(E,e.deskChannelFilter,!0)&&o("string",e.pinnedChannelUrls,!0)).throw(C.invalidParameters),[2,this._manager.getUnreadMessageCount(e)]}))}))},n.prototype.getMessageTemplates=function(t){return void 0===t&&(t={}),c(this,void 0,void 0,(function(){var e;return d(this,(function(n){return e=l(l({},D),t),A(function(t){return a("number",t.limit,!0)&&o("string",t.keys,!0)}(e)).throw(C.invalidParameters),[2,this._manager.getMessageTemplates(t)]}))}))},n.prototype.getMessageTemplate=function(t){return c(this,void 0,void 0,(function(){return d(this,(function(e){return A(a("string",t)).throw(C.invalidParameters),[2,this._manager.getMessageTemplate(t)]}))}))},n}(m);export{w as AIAgentChannelFilter,rt as AIAgentGroupChannelListQuery,st as AIAgentModule,j as ConversationListOrder,it as ConversationListQuery,E as DeskChannelFilter};
