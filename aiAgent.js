import{c as e,A as t,bu as n,e as i,f as r,g as s,a,a1 as o,j as l,bA as u,a4 as h,_ as c,b as d,V as g,aa as p,u as v,aq as _,aW as f,t as C,b7 as m,F as A}from"./lib/__bundle-5b029511.js";export{bB as AIAgentInfo}from"./lib/__bundle-5b029511.js";import{I as k,b as y,J as b,K as U,L as F}from"./lib/__bundle-70be5844.js";export{I as Conversation,W as ConversationChannelInfo,R as ConversationHandoff,V as ConversationResolution,L as ConversationStatus,N as ConversationType}from"./lib/__bundle-70be5844.js";import"./lib/__bundle-c608704b.js";import"./lib/__bundle-a9a670c6.js";import"./lib/__bundle-da8f119c.js";import"./lib/__bundle-acd77193.js";var w,E,S=function(r){function s(e){var s=e.aiAgentId,a=e.userId,o=e.language,l=e.country,u=e.context,h=e.forceCreateChannel,c=e.knownActiveChannelUrl,d=r.call(this)||this;return d.method=t.POST,d.path="".concat(n,"/ai_agents/").concat(encodeURIComponent(s),"/messenger_settings"),d.requireAuth=!1,d.params=i({user_id:a,country:l,language:o,context:u,force_create:h,known_active_channel_url:c}),d}return e(s,r),s}(r),M=function(t){function n(e,n){var i=t.call(this,e,n)||this;return i.settings=n,i}return e(n,t),n}(s),T=function(r){function s(e){var s=this,a=e.token,o=e.limit,l=e.aiAgentId,u=e.status,h=e.reverse,c=e.order;return(s=r.call(this)||this).method=t.GET,s.path="".concat(n,"/my_conversations"),s.params=i({token:a,limit:o,reverse:h,order:c,status:u,bot_userid:l}),s}return e(s,r),s}(r),x=function(t){function n(e,n){var i=t.call(this,e,n)||this;i.conversations=[];var r=n.next_token,s=n.conversations;return i.token=r,s&&s.length>0&&(i.conversations=s.map((function(e){return new k(e)}))),i}return e(n,t),n}(s),D={limit:10},q=function(r){function s(e){var s=this,a=e.limit,o=void 0===a?D.limit:a,l=e.keys,u=e.token;return(s=r.call(this)||this).method=t.GET,s.path="".concat(n,"/sdk_message_templates"),s.params=i({limit:o,keys:l,token:u}),s}return e(s,r),s}(r),G=function(t){function n(e,n){var i=t.call(this,e,n)||this,r=n.templates,s=n.template_list_token;return i.token=s,i.templates=r.map((function(e){return{template:JSON.stringify(e)}})),i}return e(n,t),n}(s),Q=function(i){function r(e){var r=this,s=e.key;return(r=i.call(this)||this).method=t.GET,r.path="".concat(n,"/sdk_message_templates/").concat(s),r}return e(r,i),r}(r),P=function(t){function n(e,n){var i=t.call(this,e,n)||this;return i.template=JSON.stringify(n),i}return e(n,t),n}(s);!function(e){e.INCLUDE="include",e.EXCLUDE="exclude"}(w||(w={})),function(e){e.INCLUDE="include",e.EXCLUDE="exclude"}(E||(E={}));var j,O={aiAgentChannelFilter:w.INCLUDE,aiAgentIds:[],deskChannelFilter:E.INCLUDE,pinnedChannelUrls:[]},H=function(n){function r(e){var r=n.call(this)||this,s=l(l({},O),e),a=s.aiAgentChannelFilter,o=s.aiAgentIds,h=s.deskChannelFilter,c=s.aiAgentConversationStatusFilter,d=s.pinnedChannelUrls,g=s.userId,p=s.token,v=s.limit;return r.method=t.GET,r.path="".concat(u,"/").concat(encodeURIComponent(g),"/my_group_channels"),r.params=i({token:p,limit:v,ai_agent_channel_filter:a,desk_channel_filter:h}),c&&c.length>0&&(r.params.ai_agent_conversation_status_filter=c),o&&o.length>0&&(r.params.ai_agent_ids=o),d&&d.length>0&&(r.params.pinned_channel_urls=d),r}return e(r,n),r}(r),X=function(t){function n(e,n){var i=t.call(this,e,n)||this;i.channels=[];var r=n.next,s=n.channels,a=n.ts;return i.token=r,s&&s.length>0&&(i.channels=s.map((function(t){return t.ts=a,new y(e,t)}))),i.ts=null!=a?a:0,i}return e(n,t),n}(s),B={aiAgentChannelFilter:w.INCLUDE,aiAgentIds:[],deskChannelFilter:E.INCLUDE,pinnedChannelUrls:[]},J=function(e){return h(w,e.aiAgentChannelFilter,!0)&&o("string",e.aiAgentIds,!0)&&h(E,e.deskChannelFilter,!0)&&o("string",e.pinnedChannelUrls,!0)},z=function(n){function r(e){var r=e.userId,s=e.ts,a=e.token,o=e.params,h=n.call(this)||this,c=l(l({},B),o),d=c.aiAgentChannelFilter,g=c.aiAgentIds,p=c.deskChannelFilter,v=c.pinnedChannelUrls;return h.method=t.GET,h.path="".concat(u,"/").concat(encodeURIComponent(r),"/my_group_channels/changelogs"),h.params=i({token:a,change_ts:s,ai_agent_channel_filter:d,desk_channel_filter:p}),g&&g.length>0&&(h.params.ai_agent_ids=g),v&&v.length>0&&(h.params.pinned_channel_urls=v),h}return e(r,n),r}(r),K=function(t){function n(e,n){var i=t.call(this,e,n)||this;return i.updatedChannels=n.updated.map((function(t){var i=Object.assign(t,{ts:n.ts});return new y(e,i)})),i.deletedChannelUrls=n.deleted,i.hasMore=n.has_more,i.token=n.next,i.ts=n.ts,i}return e(n,t),n}(s),Y={aiAgentChannelFilter:w.INCLUDE,aiAgentIds:[],deskChannelFilter:E.INCLUDE,pinnedChannelUrls:[]},Z=function(n){function r(e){var r=e.userId,s=e.params,a=n.call(this)||this,o=l(l({},Y),s),h=o.aiAgentChannelFilter,c=o.aiAgentConversationStatusFilter,d=o.aiAgentIds,g=o.deskChannelFilter,p=o.pinnedChannelUrls;return a.method=t.GET,a.path="".concat(u,"/").concat(encodeURIComponent(r),"/my_group_channels/unread_message_count"),a.params=i({ai_agent_channel_filter:h,desk_channel_filter:g}),c&&c.length>0&&(a.params.ai_agent_conversation_status_filter=c),d&&d.length>0&&(a.params.ai_agent_ids=d),p&&p.length>0&&(a.params.pinned_channel_urls=p),a}return e(r,n),r}(r),$=function(t){function n(e,n){var i=t.call(this,e,n)||this;return i.total=n.total,i.aiAgentChannelCount=n.ai_agent_channel,i.deskChannelCount=n.desk_channel,i.pinnedChannel=n.pinned_channel.map((function(e){return{channelUrl:e.channel_url,count:e.count}})),i}return e(n,t),n}(s),ee={},te=function(){function e(e,t){var n=t.sdkState,i=t.requestQueue,r=t.logger,s=t.dispatcher;this._iid=e,this._sdkState=n,this._requestQueue=i,this._logger=r,this._dispatcher=s,ee[e]=this}return e.of=function(e){return ee[e]},e.prototype.requestMessengerSettings=function(e){return c(this,void 0,void 0,(function(){var t,n,i;return d(this,(function(r){switch(r.label){case 0:return t=g.of(this._iid).requestQueue,n=new S(e),[4,t.commandRouter.send(n)];case 1:return i=r.sent(),[2,i.as(M).settings]}}))}))},e.prototype.getConversations=function(e,t,n){return c(this,void 0,void 0,(function(){var i,r,s,a,o,u;return d(this,(function(h){switch(h.label){case 0:return i=g.of(this._iid).requestQueue,r=new T(l(l({},t),{token:e,limit:n})),[4,i.send(r)];case 1:return s=h.sent(),a=s.as(x),o=a.conversations,u=a.token,[2,{conversations:o,token:u}]}}))}))},e.prototype.getMessageTemplates=function(e){return void 0===e&&(e={}),c(this,void 0,void 0,(function(){var t,n,i,r,s,a,o;return d(this,(function(l){switch(l.label){case 0:return t=e.keys,n=e.limit,i=new q({keys:t,limit:n}),[4,this._requestQueue.send(i)];case 1:return r=l.sent(),s=r.as(G),a=s.templates,o=s.token,[2,{templates:a,token:o}]}}))}))},e.prototype.getMessageTemplate=function(e){return c(this,void 0,void 0,(function(){var t,n;return d(this,(function(i){switch(i.label){case 0:return t=new Q({key:e}),[4,this._requestQueue.send(t)];case 1:return n=i.sent(),[2,{template:n.as(P).template}]}}))}))},e.prototype.getMyGroupChannels=function(e,t,n,i){return void 0===i&&(i=p.REQUEST_CHANNEL),c(this,void 0,void 0,(function(){var r,s,a,o,u,h;return d(this,(function(c){switch(c.label){case 0:return r=new H(l(l({},t),{userId:this._sdkState.userId,token:e,limit:n})),[4,this._requestQueue.send(r)];case 1:return s=c.sent(),a=s.as(X),o=a.channels,u=a.token,h=a.ts,this._dispatcher.dispatch(new b({channels:o,context:{source:i}})),[2,{channels:o,token:u,ts:h}]}}))}))},e.prototype.getMyGroupChannelChangeLogs=function(e,t,n){return void 0===n&&(n=p.REQUEST_CHANNEL_CHANGELOGS),c(this,void 0,void 0,(function(){var i,r,s,a,o,l,u,h,c;return d(this,(function(d){switch(d.label){case 0:return i="string"==typeof e?e:null,r="number"==typeof e?e:null,s=new z(v({userId:this._sdkState.userId,ts:r,token:i,params:t})),[4,this._requestQueue.send(s)];case 1:return a=d.sent(),o=a.as(K),l=o.updatedChannels,u=o.deletedChannelUrls,h=o.hasMore,c=o.ts,l.length>0&&this._dispatcher.dispatch(new b({channels:l,context:{source:n},ts:c})),u.length>0&&this._dispatcher.dispatch(new U({channelUrls:u,context:{source:n}})),[2,{updatedChannels:l,deletedChannelUrls:u,hasMore:h,token:o.token}]}}))}))},e.prototype.getUnreadMessageCount=function(e){return c(this,void 0,void 0,(function(){var t,n,i,r,s,a,o;return d(this,(function(l){switch(l.label){case 0:return t=new Z({userId:this._sdkState.userId,params:e}),[4,this._requestQueue.send(t)];case 1:return n=l.sent(),i=n.as($),r=i.total,s=i.aiAgentChannelCount,a=i.deskChannelCount,o=i.pinnedChannel,[2,{total:r,aiAgentChannelCount:s,deskChannelCount:a,pinnedChannel:o}]}}))}))},e}();!function(e){e.CREATED_AT="created_at",e.UPDATED_AT="updated_at"}(j||(j={}));var ne={status:void 0,aiAgentId:void 0,reverse:!1,order:j.UPDATED_AT},ie=function(t){function n(e,n){var i,r,s,a,o=this;return(o=t.call(this,e,n)||this).status=null!==(i=n.status)&&void 0!==i?i:void 0,o.aiAgentId=null!==(r=n.aiAgentId)&&void 0!==r?r:void 0,o.reverse=null!==(s=n.reverse)&&void 0!==s?s:ne.reverse,o.order=null!==(a=n.order)&&void 0!==a?a:ne.order,o}return e(n,t),n.prototype._validate=function(){return t.prototype._validate.call(this)&&h(F,this.status,!0)&&a("string",this.aiAgentId,!0)&&a("boolean",this.reverse)&&h(j,this.order)},n.prototype.serialize=function(){return _(this)},n.prototype.next=function(){return c(this,void 0,void 0,(function(){var e,t,n,i;return d(this,(function(r){switch(r.label){case 0:return e=te.of(this._iid),this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,[4,e.getConversations(this._token,v(l({},this)),this.limit)]):[3,2]:[3,5];case 1:return t=r.sent(),n=t.conversations,i=t.token,this._token=i,this._hasNext=!!i,this._isLoading=!1,[2,n];case 2:return[2,[]];case 3:throw C.queryInProgress;case 4:return[3,6];case 5:throw C.invalidParameters;case 6:return[2]}}))}))},n}(f),re=function(t){function n(e,n){var i=t.call(this,e,n)||this;return i._ts=0,i.aiAgentChannelFilter=O.aiAgentChannelFilter,i.aiAgentIds=O.aiAgentIds,i.deskChannelFilter=O.deskChannelFilter,i.pinnedChannelUrls=O.pinnedChannelUrls,n.aiAgentChannelFilter&&(i.aiAgentChannelFilter=n.aiAgentChannelFilter),n.aiAgentConversationStatusFilter&&(i.aiAgentConversationStatusFilter=n.aiAgentConversationStatusFilter),n.aiAgentIds&&(i.aiAgentIds=n.aiAgentIds),n.deskChannelFilter&&(i.deskChannelFilter=n.deskChannelFilter),n.pinnedChannelUrls&&(i.pinnedChannelUrls=n.pinnedChannelUrls),i}return e(n,t),n.prototype._validate=function(){return t.prototype._validate.call(this)&&h(w,this.aiAgentChannelFilter)&&o(F,this.aiAgentConversationStatusFilter,!0)&&o("string",this.aiAgentIds)&&h(E,this.deskChannelFilter)&&o("string",this.pinnedChannelUrls)},n.prototype.serialize=function(){return _(this)},Object.defineProperty(n.prototype,"lastResponseAt",{get:function(){return this._ts},enumerable:!1,configurable:!0}),n.prototype.belongsTo=function(e){if(this.pinnedChannelUrls.includes(e.url))return!0;if(e.isAIAgent&&!e.conversation)return!1;if(this.aiAgentChannelFilter===w.EXCLUDE)if(e.isAIAgent)return!1;if(this.aiAgentConversationStatusFilter&&e.isAIAgent&&!this.aiAgentConversationStatusFilter.some((function(t){var n;return(null===(n=e.conversation)||void 0===n?void 0:n.status)===t})))return!1;if(this.deskChannelFilter===E.EXCLUDE)if(e.isDesk)return!1;return!0},n.prototype.next=function(){return c(this,void 0,void 0,(function(){var e,t,n,i,r,s;return d(this,(function(a){switch(a.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=te.of(this._iid),t=v({aiAgentChannelFilter:this.aiAgentChannelFilter,aiAgentConversationStatusFilter:this.aiAgentConversationStatusFilter,aiAgentIds:this.aiAgentIds,deskChannelFilter:this.deskChannelFilter,pinnedChannelUrls:this.pinnedChannelUrls}),[4,e.getMyGroupChannels(this._token,t,this.limit)]):[3,2]:[3,5];case 1:return n=a.sent(),i=n.channels,r=n.token,s=n.ts,this._token=r,this._hasNext=!!r,this._isLoading=!1,this._ts=s,[2,i];case 2:return[2,[]];case 3:throw C.queryInProgress;case 4:return[3,6];case 5:throw C.invalidParameters;case 6:return[2]}}))}))},n}(f),se=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="aiAgent",e}return e(n,t),n.prototype.init=function(e,n){var i=n.sdkState,r=n.dispatcher,s=n.sessionManager,a=n.requestQueue,o=n.logger,l=n.onlineDetector,u=n.cacheContext;t.prototype.init.call(this,e,{sdkState:i,dispatcher:r,sessionManager:s,requestQueue:a,logger:o,onlineDetector:l,cacheContext:u}),this._manager=new te(e,{sdkState:i,requestQueue:a,logger:o,dispatcher:r})},n.prototype.requestMessengerSettings=function(e){return c(this,void 0,void 0,(function(){var t,n,i,r,s,o,l;return d(this,(function(u){return t=e.aiAgentId,n=e.userId,i=e.language,r=e.country,s=e.context,o=e.forceCreateChannel,l=e.knownActiveChannelUrl,A(a("string",t)&&a("string",n,!0)&&a("string",i,!0)&&a("string",r,!0)&&a("object",s,!0)&&a("boolean",o,!0)&&a("string",l,!0)).throw(C.invalidParameters),[2,this._manager.requestMessengerSettings(e)]}))}))},n.prototype.createConversationListQuery=function(e){return void 0===e&&(e={}),new ie(this._iid,e)},n.prototype.createMyGroupChannelListQuery=function(e){return void 0===e&&(e={}),new re(this._iid,e)},n.prototype.getMyGroupChannelChangeLogsByToken=function(e,t){return void 0===t&&(t={}),c(this,void 0,void 0,(function(){var n;return d(this,(function(i){switch(i.label){case 0:return n=l(l({},B),t),A(a("string",e)&&J(n)).throw(C.invalidParameters),[4,this._manager.getMyGroupChannelChangeLogs(e,n)];case 1:return[2,i.sent()]}}))}))},n.prototype.getMyGroupChannelChangeLogsByTimestamp=function(e,t){return void 0===t&&(t={}),c(this,void 0,void 0,(function(){var n;return d(this,(function(i){switch(i.label){case 0:return n=l(l({},B),t),A(a("number",e)&&J(n)).throw(C.invalidParameters),[4,this._manager.getMyGroupChannelChangeLogs(e,n)];case 1:return[2,i.sent()]}}))}))},n.prototype.getUnreadMessageCount=function(e){return void 0===e&&(e={}),c(this,void 0,void 0,(function(){var t;return d(this,(function(n){return t=l(l({},Y),e),A(h(w,t.aiAgentChannelFilter,!0)&&o(F,t.aiAgentConversationStatusFilter,!0)&&o("string",t.aiAgentIds,!0)&&h(E,t.deskChannelFilter,!0)&&o("string",t.pinnedChannelUrls,!0)).throw(C.invalidParameters),[2,this._manager.getUnreadMessageCount(t)]}))}))},n.prototype.getMessageTemplates=function(e){return void 0===e&&(e={}),c(this,void 0,void 0,(function(){var t;return d(this,(function(n){return t=l(l({},D),e),A(function(e){return a("number",e.limit,!0)&&o("string",e.keys,!0)}(t)).throw(C.invalidParameters),[2,this._manager.getMessageTemplates(e)]}))}))},n.prototype.getMessageTemplate=function(e){return c(this,void 0,void 0,(function(){return d(this,(function(t){return A(a("string",e)).throw(C.invalidParameters),[2,this._manager.getMessageTemplate(e)]}))}))},n}(m);export{w as AIAgentChannelFilter,re as AIAgentGroupChannelListQuery,se as AIAgentModule,j as ConversationListOrder,ie as ConversationListQuery,E as DeskChannelFilter};
