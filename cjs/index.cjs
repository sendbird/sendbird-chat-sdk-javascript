Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./lib/__bundle-e9058e21.cjs"),t=require("./message.cjs"),s=require("./poll.cjs"),i=require("./lib/__bundle-aa4f7e01.cjs"),n=require("./lib/__bundle-87e0c6e4.cjs"),r=require("./lib/__bundle-9cd5400b.cjs"),o=require("./lib/__bundle-ead98b3e.cjs");require("./lib/__bundle-b2c2f035.cjs"),require("./lib/__bundle-dae7bdf2.cjs");class a{constructor(e){this.key=e.key,this.url=e.url}}class d{constructor(e){this.id=e.id,this.name=e.name,this.url=e.url,this.emojis=e.emojis?e.emojis.map((e=>new a(e))):[]}}class u{constructor(e){this.emojiHash=e.emoji_hash||"",this.emojiCategories=e.emoji_categories?e.emoji_categories.map((e=>new d(e))):[]}}class c{constructor(){this.onConnected=e.noop,this.onReconnectStarted=e.noop,this.onReconnectSucceeded=e.noop,this.onReconnectFailed=e.noop,this.onConnectionLost=e.noop,this.onDisconnected=e.noop,this.onConnectionDelayed=e.noop}}class l extends c{constructor(e={}){super(),Object.keys(e).forEach((t=>{this.hasOwnProperty(t)&&(this[t]=e[t])}))}}class h{constructor(){this.onSessionExpired=e.noop,this.onSessionTokenRequired=e=>e(null),this.onSessionError=e.noop,this.onSessionRefreshed=e.noop,this.onSessionClosed=e.noop}}class p extends h{constructor(e={}){super(),Object.keys(e).forEach((t=>{this.hasOwnProperty(t)&&(this[t]=e[t])}))}}class _{constructor(){this.onFriendsDiscovered=e.noop,this.onTotalUnreadMessageCountChanged=e.noop,this.onTotalUnreadMessageCountUpdated=e.noop}}class f extends _{constructor(e={}){super(),Object.keys(e).forEach((t=>{this.hasOwnProperty(t)&&(this[t]=e[t])}))}}class m extends e.APIRequestCommand{constructor({limit:t,token:s,userIdsFilter:i,metaDataKeyFilter:n,metaDataValuesFilter:r,nicknameStartsWithFilter:o}){super(),this.method=e.APIRequestMethod.GET,this.path=e.API_PATH_USERS,this.params=e.deundefined({limit:t,token:s,user_ids:i,metadatakey:n,metadatavalues_in:r,nickname_startswith:o})}}class g extends e.APIResponseCommand{constructor(t,s){super(t,s),this.users=s.users.map((s=>new e.User(t,s))),this.next=s.next}}class v extends e.BaseListQuery{constructor(e,t){var s,i,n;super(e,t),this.userIdsFilter=null,this.metaDataKeyFilter=null,this.metaDataValuesFilter=null,this.nicknameStartsWithFilter=null,this.userIdsFilter=null!==(s=t.userIdsFilter)&&void 0!==s?s:null,this.metaDataKeyFilter=null!==(i=t.metaDataKeyFilter)&&void 0!==i?i:null,this.metaDataValuesFilter=null!==(n=t.metaDataValuesFilter)&&void 0!==n?n:null,this.nicknameStartsWithFilter=t.nicknameStartsWithFilter||null}_validate(){return super._validate()&&e.isArrayOf("string",this.userIdsFilter,!0)&&e.isTypeOf("string",this.metaDataKeyFilter,!0)&&e.isArrayOf("string",this.metaDataValuesFilter,!0)&&e.isTypeOf("string",this.nicknameStartsWithFilter,!0)}next(){return e.__awaiter(this,void 0,void 0,(function*(){if(this._validate()){if(this._isLoading)throw e.SendbirdError.queryInProgress;if(this._hasNext){this._isLoading=!0;const{requestQueue:t}=e.Vault.of(this._iid),s=new m(e.undefineNullProps(Object.assign(Object.assign({},this),{token:this._token}))),i=yield t.send(s),{users:n,next:r}=i.as(g);return this._token=r,this._hasNext=!!r,this._isLoading=!1,n}return[]}throw e.SendbirdError.invalidParameters}))}}class y extends e.APIRequestCommand{constructor({userId:t,limit:s,token:i,userIdsFilter:n}){super(),this.method=e.APIRequestMethod.GET,this.path=`${e.API_PATH_USERS}/${encodeURIComponent(t)}/block`,this.params=e.deundefined({limit:s,token:i,user_ids:n})}}class S extends e.APIResponseCommand{constructor(t,s){super(t,s),this.users=s.users.map((s=>new e.User(t,s))),this.next=s.next}}class I extends e.BaseListQuery{constructor(e,t){var s;super(e,t),this.userIdsFilter=null,this.userIdsFilter=null!==(s=t.userIdsFilter)&&void 0!==s?s:null}_validate(){return super._validate()&&e.isArrayOf("string",this.userIdsFilter,!0)}next(){return e.__awaiter(this,void 0,void 0,(function*(){if(this._validate()){if(this._isLoading)throw e.SendbirdError.queryInProgress;if(this._hasNext){this._isLoading=!0;const{sdkState:t,requestQueue:s}=e.Vault.of(this._iid),i=new y(e.undefineNullProps(Object.assign(Object.assign({},this),{userId:t.userId,token:this._token}))),n=yield s.send(i),{users:r,next:o}=n.as(S);return this._token=o,this._hasNext=!!o,this._isLoading=!1,r}return[]}throw e.SendbirdError.invalidParameters}))}}class C extends e.APIRequestCommand{constructor({userId:t,limit:s,token:i}){super(),this.method=e.APIRequestMethod.GET,this.path=`${e.API_PATH_USERS}/${encodeURIComponent(t)}/friends`,this.params={limit:s,token:i}}}class E extends e.APIResponseCommand{constructor(t,s){super(t,s),this.hasMore=s.has_more,this.users=s.users.map((s=>new e.User(t,s))),this.next=s.next}}class P extends e.BaseListQuery{_validate(){return super._validate()}next(){return e.__awaiter(this,void 0,void 0,(function*(){if(this._validate()){if(this._isLoading)throw e.SendbirdError.queryInProgress;if(this._hasNext){this._isLoading=!0;const{sdkState:t,requestQueue:s}=e.Vault.of(this._iid),i=new C(Object.assign(Object.assign({},this),{userId:t.userId,token:this._token})),n=yield s.send(i),{users:r,hasMore:o,next:a}=n.as(E);return this._token=a,this._hasNext=o,this._isLoading=!1,r}return[]}throw e.SendbirdError.invalidParameters}))}}const T=2097152;class b extends i.BaseStore{constructor(t){var{AsyncStorage:s,itemSizeLimit:i=T}=t,n=e.__rest(t,["AsyncStorage","itemSizeLimit"]);super(Object.assign(Object.assign({},n),{itemSizeLimit:i})),this._asyncStorage=s}_isBelonging(e){return e.startsWith(`${this.dbname}/`)}_getActualKey(e){return`${this.dbname}/${e}`}_getAllRawKeys(){return e.__awaiter(this,void 0,void 0,(function*(){return(yield this._asyncStorage.getAllKeys()).filter((e=>this._isBelonging(e))).map((e=>e.substring(`${this.dbname}/`.length)))}))}_getRaw(t){return e.__awaiter(this,void 0,void 0,(function*(){const e=yield this._asyncStorage.getItem(this._getActualKey(t));return e?JSON.parse(e):null}))}_setRaw(t){return e.__awaiter(this,void 0,void 0,(function*(){const e=[];for(const s of t){const{key:t,data:i}=s;i.length<=this.adjustedItemSizeLimit&&e.push([this._getActualKey(t),JSON.stringify(s)])}yield this._asyncStorage.multiSet(e)}))}_removeRaw(t){return e.__awaiter(this,void 0,void 0,(function*(){yield this._asyncStorage.multiRemove(t.map((e=>this._getActualKey(e))))}))}checkAvailability(){return e.__awaiter(this,void 0,void 0,(function*(){if(!this._asyncStorage)throw i.NestDBError.storeNotAvailable}))}init(t){return e.__awaiter(this,void 0,void 0,(function*(){this.dbname=t,yield this._resetIfEncryptionChanged()}))}clear(){const t=Object.create(null,{clear:{get:()=>super.clear}});return e.__awaiter(this,void 0,void 0,(function*(){yield t.clear.call(this);const e=yield this.getAllKeys();yield this.removeMany(e)}))}}class A extends i.BaseStore{constructor(e){var t,s;super(Object.assign(Object.assign({},e),{itemSizeLimit:null!==(t=e.itemSizeLimit)&&void 0!==t?t:6291456})),this._mmkv=(s=e.MMKV,{getString:e=>s.getString(e),set:(e,t)=>s.set(e,t),delete:e=>s.remove?s.remove(e):s.delete(e),getAllKeys:()=>s.getAllKeys()})}_isBelonging(e){return e.startsWith(`${this.dbname}/`)}_getActualKey(e){return`${this.dbname}/${e}`}_getAllRawKeys(){return e.__awaiter(this,void 0,void 0,(function*(){return(yield this._mmkv.getAllKeys()).filter((e=>this._isBelonging(e))).map((e=>e.substring(`${this.dbname}/`.length)))}))}_getRaw(t){return e.__awaiter(this,void 0,void 0,(function*(){const e=yield this._mmkv.getString(this._getActualKey(t));return e?JSON.parse(e):null}))}_setRaw(t){return e.__awaiter(this,void 0,void 0,(function*(){for(const e of t){const{key:t,data:s}=e;s.length<=this.adjustedItemSizeLimit&&this._mmkv.set(this._getActualKey(t),JSON.stringify(e))}}))}_removeRaw(t){return e.__awaiter(this,void 0,void 0,(function*(){for(const e of t)this._mmkv.delete(this._getActualKey(e))}))}checkAvailability(){return e.__awaiter(this,void 0,void 0,(function*(){if(!this._mmkv)throw i.NestDBError.storeNotAvailable}))}init(t){return e.__awaiter(this,void 0,void 0,(function*(){this.dbname=t,yield this._resetIfEncryptionChanged()}))}clear(){const t=Object.create(null,{clear:{get:()=>super.clear}});return e.__awaiter(this,void 0,void 0,(function*(){yield t.clear.call(this);const e=yield this.getAllKeys();yield this.removeMany(e)}))}}const w={profileImage:void 0,profileUrl:void 0,nickname:void 0},k=t=>({v2:()=>e.__awaiter(void 0,void 0,void 0,(function*(){return yield t.commitSchema([{collectionName:i.NESTDB_GROUPCHANNEL_COLLECTION_NAME,keyName:i.NESTDB_GROUPCHANNEL_COLLECTION_KEY,index:[n.getGroupChannelIndexBy(n.GroupChannelListOrder.LATEST_LAST_MESSAGE),n.getGroupChannelIndexBy(n.GroupChannelListOrder.CHRONOLOGICAL),n.getGroupChannelIndexBy(n.GroupChannelListOrder.CHANNEL_NAME_ALPHABETICAL)]},{collectionName:i.NESTDB_MESSAGE_COLLECTION_NAME,keyName:i.NESTDB_MESSAGE_COLLECTION_KEY,index:[i.getMessageIndexBy(i.MessageListOrder.CHANNEL_LATEST),i.getMessageIndexBy(i.MessageListOrder.NEWEST_CHILD_MESSAGE)]},{collectionName:i.NESTDB_UNSENT_MESSAGE_COLLECTION_NAME,keyName:i.NESTDB_UNSENT_MESSAGE_COLLECTION_KEY,index:[i.getMessageIndexBy(i.MessageListOrder.CHANNEL_LATEST),i.getMessageIndexBy(i.MessageListOrder.NEWEST_CHILD_MESSAGE)]},{collectionName:i.NESTDB_POLL_COLLECTION_NAME,keyName:i.NESTDB_POLL_COLLECTION_KEY}])})),v3:()=>e.__awaiter(void 0,void 0,void 0,(function*(){return yield t.commitSchema([{collectionName:i.NESTDB_FEEDCHANNEL_COLLECTION_NAME,keyName:i.NESTDB_FEEDCHANNEL_COLLECTION_KEY,index:[r.getFeedChannelIndexBy("latest_last_message")]}])})),v4:()=>e.__awaiter(void 0,void 0,void 0,(function*(){return yield t.commitSchema([{collectionName:i.NESTDB_NOTIFICATION_COLLECTION_NAME,keyName:i.NESTDB_NOTIFICATION_COLLECTION_KEY,index:[i.getNotificationMessageIndexBy()]}])})),v5:()=>e.__awaiter(void 0,void 0,void 0,(function*(){return yield t.commitSchema([{collectionName:i.NESTDB_USER_INFO_COLLECTION_NAME,keyName:i.NESTDB_USER_INFO_COLLECTION_KEY,index:[["-userId","-updatedAt"]]}])}))}),O=t=>{const s=new i.Logger;return(n,r)=>e.__awaiter(void 0,void 0,void 0,(function*(){switch(n){case 1:case 2:case 3:case 4:default:r();break;case 5:yield t.reset(),r();break;case 6:try{const{v2:s,v3:n,v4:r}=k(t);yield s(),yield n(),yield r();const o=t.collection(i.NESTDB_MESSAGE_COLLECTION_NAME);yield o.removeIf({where:{channelType:e.ChannelType.OPEN}})}catch(e){s.warn("Failed to migrate to v2, v3, v4")}r();break;case 7:try{const{v5:e}=k(t);yield e()}catch(e){s.warn("Failed to migrate to v5")}r()}}))},R=()=>"undefined"!=typeof document?document.visibilityState:"visible";class N extends e.EventDispatcher{constructor({getVisibilityState:e=R,initialState:t="visible",isEnabled:s=!0,pauseCheckDelay:i,supportMultipleTabs:n=!1,localCacheEnabled:r=!1}){super(),this._currentVisibility="visible",this._activeTimestamp=0,this._storageKey="",this._onMessage=e=>{if(!this.isActive)return;const t=e.data;if(t.tabId!==this._tabId&&"SB_ACTIVE_APP"===t.type){if(t.timestamp<=this._activeTimestamp)return;this._changeAppStateToInactive()}},this._onStorage=e=>{if(this.isActive&&e.key===this._storageKey&&e.newValue)try{const t=JSON.parse(e.newValue);if(t.tabId===this._tabId||t.timestamp<=this._activeTimestamp)return;this._changeAppStateToInactive()}catch(e){console.warn("failed to parse active tab info from storage",e)}},this._toggleFocusState=()=>{this.isActive||"visible"===this._currentVisibility&&this._changeAppStateToActive()},this._toggleStateByVisibilityState=()=>{const e=this._getVisibilityState();if("visible"===e){if("hidden"===this._currentVisibility){if(this.isActive)return;this._changeAppStateToActive(),this._dispatchAppStateEvent()}}else if("hidden"===e&&"visible"===this._currentVisibility){if(!this.isActive)return;this._changeAppStateToInactive()}this._currentVisibility=e},this._dispatchAppStateEvent=()=>{this.isActive?this.dispatch("resume"):(this._clearPauseTimer(),this._pauseCheckDelay&&(this._pauseDelayTimer=setTimeout((()=>{this._pauseDelayTimer=void 0,this.dispatch("pause")}),this._pauseCheckDelay)))},this._dispatchLocalCacheEvent=()=>{this.isActive?this.dispatch("enable_local_cache"):this.dispatch("disable_local_cache")},this._changeAppStateToActive=()=>{if(this._clearPauseTimer(),this._activeTimestamp=Date.now(),this._currentState="ACTIVE",!this._supportMultipleTabs&&this._pauseCheckDelay||this._dispatchLocalCacheEvent(),this._supportMultipleTabs){const e={tabId:this._tabId,timestamp:this._activeTimestamp};this._broadcastChannel?this._broadcastChannel.postMessage(Object.assign({type:"SB_ACTIVE_APP"},e)):localStorage.setItem(this._storageKey,JSON.stringify(e))}},this._changeAppStateToInactive=()=>{const e=this._getVisibilityState();this._currentState="INACTIVE",!this._supportMultipleTabs&&this._pauseCheckDelay||this._dispatchLocalCacheEvent(),"hidden"===e&&this._dispatchAppStateEvent()},this._clearPauseTimer=()=>{this._pauseDelayTimer&&(clearTimeout(this._pauseDelayTimer),this._pauseDelayTimer=void 0)},this._getVisibilityState=e,this._isEnabled=s,this._supportMultipleTabs=!!r&&n,this._pauseCheckDelay=i,this._currentVisibility=t}get isActive(){return"ACTIVE"===this._currentState}get currentVisibility(){return this._currentVisibility}get isAvailableBroadCast(){return"undefined"!=typeof BroadcastChannel}get isAvailable(){return"undefined"!=typeof window&&!!window.addEventListener&&!!window.removeEventListener}start({appId:t,userId:s,backgroundConnectionCloseTimeout:i}){if(this._isEnabled&&this.isAvailable){if(void 0!==i&&-1!==i&&(this._pauseCheckDelay=0===i?10:1e3*i),this._supportMultipleTabs){const i=`sendbird-${t}-${s}`;if(this._tabId=`${i}-${e.uuid()}`,this._storageKey=`sendbird-active-app:${t}-${s}`,this.isAvailableBroadCast)try{this._broadcastChannel=new BroadcastChannel(i),this._broadcastChannel.onmessage=this._onMessage}catch(e){window.addEventListener("storage",this._onStorage,{capture:!0})}else window.addEventListener("storage",this._onStorage,{capture:!0});window.addEventListener("focus",this._toggleFocusState,{capture:!0}),window.addEventListener("pointerdown",this._toggleFocusState,{capture:!0})}window.addEventListener("visibilitychange",this._toggleStateByVisibilityState,{capture:!0}),"hidden"!==this.currentVisibility?this._changeAppStateToActive():this._currentState="INACTIVE"}}stop(){this._isEnabled&&this.isAvailable&&(this._clearPauseTimer(),this._supportMultipleTabs&&(this._broadcastChannel?(this._broadcastChannel.onmessage=null,this._broadcastChannel.close(),this._broadcastChannel=void 0):window.removeEventListener("storage",this._onStorage,{capture:!0}),window.removeEventListener("focus",this._toggleFocusState,{capture:!0}),window.removeEventListener("pointerdown",this._toggleFocusState,{capture:!0})),window.removeEventListener("visibilitychange",this._toggleStateByVisibilityState,{capture:!0}),this._tabId="",this._currentState="INACTIVE",this._activeTimestamp=0)}}class U{constructor({logger:e,connectionDelegate:t=null}){this._onlineWorker=()=>{var e;return null===(e=this.connectionDelegate)||void 0===e?void 0:e.reconnect()},this._offlineWorker=()=>{var e;return null===(e=this.connectionDelegate)||void 0===e?void 0:e.disconnect()},this.unsubscribes=[],this._onlineListener=e=>{if(this.isAvailableOnWeb)return window.addEventListener("online",e),()=>window.removeEventListener("online",e,!1)},this._offlineListener=e=>{if(this.isAvailableOnWeb)return window.addEventListener("offline",e),()=>window.removeEventListener("offline",e,!1)},this.logger=e,t&&(this.connectionDelegate=t)}get isAvailableOnWeb(){return"undefined"!=typeof window&&!!window.addEventListener&&"ononline"in window&&"onoffline"in window&&"undefined"!=typeof navigator&&void 0!==navigator.onLine}setOnlineListener(e){Boolean(e)&&"function"==typeof e&&(this._onlineListener=e)}setOfflineListener(e){Boolean(e)&&"function"==typeof e&&(this._offlineListener=e)}start(){this.unsubscribes=[this._onlineListener(this._onlineWorker),this._offlineListener(this._offlineWorker)]}stop(){this.unsubscribes.forEach((e=>{try{null==e||e()}catch(e){this.logger.warn(e.message)}})),this.unsubscribes=[]}isOnline(){return e.__awaiter(this,void 0,void 0,(function*(){return this.isAvailableOnWeb?navigator.onLine:new Promise((t=>{fetch("https://www.google.com",{method:e.APIRequestMethod.GET,mode:"no-cors"}).then((()=>t(!0))).catch((()=>t(!1)))}))}))}}class D extends e.APIRequestCommand{constructor(t){var s;super(),this.method=e.APIRequestMethod.GET,this.path=e.API_PATH_APP_SETTINGS_INTERNAL,this.params=e.deundefined(e.undefineNullProps({ts:"number"==typeof t.token?t.token:void 0,token:"string"==typeof t.token?t.token:void 0,limit:null!==(s=t.limit)&&void 0!==s?s:100}))}}class M extends e.APIResponseCommand{constructor(e,t){super(e,t),this.configs=t.configs,this.hasMore=t.has_more,this.nextToken=t.next,this.ts=t.ts}}class x extends e.APIRequestCommand{constructor({userId:t,nickname:s,profileUrl:i,profileImage:n,preferredLanguages:r}){super(),this.method=e.APIRequestMethod.PUT,this.path=`${e.API_PATH_USERS}/${encodeURIComponent(t)}`,this.params=e.deundefined(e.undefineNullProps({nickname:s,profile_url:i,profile_file:n,preferred_languages:r}))}}class L extends e.APIResponseCommand{constructor(t,s){super(t,s),this.user=new e.User(t,Object.assign({},s))}}class q extends e.APIRequestCommand{constructor({userId:t,token:s,deviceOS:i,deviceManufacturer:n,systemPushEnabled:r}){super(),this.method=e.APIRequestMethod.POST,this.path=`${e.API_PATH_USERS}/${encodeURIComponent(t)}/push/apns`,this.params=e.deundefined({apns_device_token:s,always_push:!0,device_os:i,device_manufacturer:n,system_push_enabled:r})}}class V extends e.APIRequestCommand{constructor({userId:t,token:s,deviceOS:i,deviceManufacturer:n,systemPushEnabled:r}){super(),this.method=e.APIRequestMethod.POST,this.path=`${e.API_PATH_USERS}/${encodeURIComponent(t)}/push/gcm`,this.params=e.deundefined({gcm_reg_token:s,always_push:!0,device_os:i,device_manufacturer:n,system_push_enabled:r})}}class $ extends e.APIRequestCommand{constructor({userId:t,token:s}){super(),this.method=e.APIRequestMethod.DELETE,this.path=`${e.API_PATH_USERS}/${encodeURIComponent(t)}/push/apns/${encodeURIComponent(s)}`}}class F extends e.APIResponseCommand{constructor(t,s){super(t,s),this.token=s.token,this.user=new e.User(t,s.user),this.lastDeletedAt=s.device_token_last_deleted_at}}class K extends e.APIRequestCommand{constructor({userId:t,token:s}){super(),this.method=e.APIRequestMethod.DELETE,this.path=`${e.API_PATH_USERS}/${encodeURIComponent(t)}/push/gcm/${encodeURIComponent(s)}`}}class H extends e.APIResponseCommand{constructor(t,s){super(t,s),this.token=s.token,this.user=new e.User(t,s.user),this.lastDeletedAt=s.device_token_last_deleted_at}}class j extends e.APIRequestCommand{constructor({userId:t}){super(),this.method=e.APIRequestMethod.DELETE,this.path=`${e.API_PATH_USERS}/${encodeURIComponent(t)}/push/apns`}}class B extends e.APIResponseCommand{constructor(t,s){super(t,s),this.type=s.type?e.PushTokenType[s.type.toLowerCase()]:e.PushTokenType.UNKNOWN,this.user=new e.User(t,s.user),this.lastDeletedAt=s.device_token_last_deleted_at}}class Q extends e.APIRequestCommand{constructor({userId:t}){super(),this.method=e.APIRequestMethod.DELETE,this.path=`${e.API_PATH_USERS}/${encodeURIComponent(t)}/push/gcm`}}class z extends e.APIResponseCommand{constructor(t,s){super(t,s),this.type=s.type?e.PushTokenType[s.type.toLowerCase()]:e.PushTokenType.UNKNOWN,this.user=new e.User(t,s.user),this.lastDeletedAt=s.device_token_last_deleted_at}}class G extends e.APIRequestCommand{constructor({userId:t,type:s,token:i,ts:n}){super(),this.method=e.APIRequestMethod.GET,this.path=`${e.API_PATH_USERS}/${encodeURIComponent(t)}/push/${encodeURIComponent(s)}/device_tokens`,this.params={created_ts:n,token:i}}}class W extends e.APIResponseCommand{constructor(t,s){super(t,s),this.pushTokens={type:s.type?e.PushTokenType[s.type.toLowerCase()]:e.PushTokenType.UNKNOWN,deviceTokens:s.device_tokens,hasMore:s.has_more,token:s.token}}}class J extends e.APIRequestCommand{constructor({userId:t}){super(),this.method=e.APIRequestMethod.GET,this.path=`${e.API_PATH_USERS}/${encodeURIComponent(t)}/channel_invitation_preference`}}class Y extends e.APIResponseCommand{constructor(e,t){super(e,t),this.autoAccept=t.auto_accept}}class X extends e.APIRequestCommand{constructor({userId:t,willAutoAccept:s}){super(),this.method=e.APIRequestMethod.PUT,this.path=`${e.API_PATH_USERS}/${encodeURIComponent(t)}/channel_invitation_preference`,this.params={auto_accept:s}}}class Z extends e.APIResponseCommand{constructor(e,t){super(e,t),this.autoAccept=t.auto_accept}}class ee extends e.APIRequestCommand{constructor({userId:t}){super(),this.method=e.APIRequestMethod.GET,this.path=`${e.API_PATH_USERS}/${encodeURIComponent(t)}/push_preference`}}class te extends e.APIResponseCommand{constructor(e,t){super(e,t),this.preference={doNotDisturbOn:t.do_not_disturb,startHour:t.start_hour,startMin:t.start_min,endHour:t.end_hour,endMin:t.end_min,timezone:t.timezone}}}class se extends e.APIRequestCommand{constructor({userId:t,doNotDisturbOn:s,startHour:i,startMin:n,endHour:r,endMin:o,timezone:a}){super(),this.method=e.APIRequestMethod.PUT,this.path=`${e.API_PATH_USERS}/${encodeURIComponent(t)}/push_preference`,this.params={do_not_disturb:s,start_hour:i,start_min:n,end_hour:r,end_min:o,timezone:a}}}class ie extends e.APIResponseCommand{constructor(e,t){super(e,t),this.preference={doNotDisturbOn:t.do_not_disturb,startHour:t.start_hour,startMin:t.start_min,endHour:t.end_hour,endMin:t.end_min,timezone:t.timezone}}}class ne extends e.APIRequestCommand{constructor({userId:t}){super(),this.method=e.APIRequestMethod.GET,this.path=`${e.API_PATH_USERS}/${encodeURIComponent(t)}/push_preference`}}class re extends e.APIResponseCommand{constructor(e,t){super(e,t),this.snoozePeriod={isSnoozeOn:t.snooze_enabled},"number"==typeof t.snooze_start_ts&&(this.snoozePeriod.startTs=t.snooze_start_ts),"number"==typeof t.snooze_end_ts&&(this.snoozePeriod.endTs=t.snooze_end_ts)}}class oe extends e.APIRequestCommand{constructor({userId:t,snoozeOn:s,startTs:i,endTs:n}){super(),this.method=e.APIRequestMethod.PUT,this.path=`${e.API_PATH_USERS}/${encodeURIComponent(t)}/push_preference`,this.params={snooze_enabled:s,snooze_start_ts:i,snooze_end_ts:n}}}class ae extends e.APIResponseCommand{constructor(e,t){super(e,t),this.snoozePeriod={isSnoozeOn:t.snooze_enabled},"number"==typeof t.snooze_start_ts&&(this.snoozePeriod.startTs=t.snooze_start_ts),"number"==typeof t.snooze_end_ts&&(this.snoozePeriod.endTs=t.snooze_end_ts)}}class de extends e.APIRequestCommand{constructor({userId:t,blockedUserId:s}){super(),this.method=e.APIRequestMethod.POST,this.path=`${e.API_PATH_USERS}/${encodeURIComponent(t)}/block`,this.params={target_id:s}}}class ue extends e.APIRequestCommand{constructor({userId:t,unblockedUserId:s}){super(),this.method=e.APIRequestMethod.DELETE,this.path=`${e.API_PATH_USERS}/${encodeURIComponent(t)}/block/${encodeURIComponent(s)}`}}class ce extends e.APIRequestCommand{constructor({userId:t}){super(),this.method=e.APIRequestMethod.GET,this.path=`${e.API_PATH_USERS}/${encodeURIComponent(t)}/push_preference`}}class le extends e.APIResponseCommand{constructor(e,t){super(e,t),this.pushTriggerOption=t.push_trigger_option}}class he extends e.APIRequestCommand{constructor({userId:t,pushTriggerOption:s}){super(),this.method=e.APIRequestMethod.PUT,this.path=`${e.API_PATH_USERS}/${encodeURIComponent(t)}/push_preference`,this.params={push_trigger_option:s}}}class pe extends e.APIResponseCommand{constructor(e,t){super(e,t),this.pushTriggerOption=t.push_trigger_option}}class _e extends e.APIRequestCommand{constructor({userId:t}){super(),this.method=e.APIRequestMethod.GET,this.path=`${e.API_PATH_USERS}/${encodeURIComponent(t)}/push/template`}}class fe extends e.APIResponseCommand{constructor(e,t){super(e,t),this.name=t.name}}class me extends e.APIRequestCommand{constructor({userId:t,templateName:s}){super(),this.method=e.APIRequestMethod.PUT,this.path=`${e.API_PATH_USERS}/${encodeURIComponent(t)}/push/template`,this.params={name:s}}}class ge extends e.APIResponseCommand{constructor(e,t){super(e,t),this.name=t.name}}class ve extends e.APIRequestCommand{constructor({userId:t,token:s}){super(),this.method=e.APIRequestMethod.GET,this.path=`${e.API_PATH_USERS}/${encodeURIComponent(t)}/friends/changelogs`,this.params={token:s}}}class ye extends e.APIResponseCommand{constructor(t,s){super(t,s),this.changelogs={addedUsers:s.added.map((s=>new e.User(t,s))),updatedUsers:s.updated.map((s=>new e.User(t,s))),deletedUserIds:s.deleted,hasMore:s.has_more,token:s.next}}}class Se extends e.APIRequestCommand{constructor({userId:t,discoveries:s}){super(),this.method=e.APIRequestMethod.PUT,this.path=`${e.API_PATH_USERS}/${encodeURIComponent(t)}/friend_discoveries`,this.params={friend_discoveries:s.map((e=>({friend_discovery_key:e.friendDiscoveryKey,friend_name:e.friendName})))}}}class Ie extends e.APIResponseCommand{constructor(e,t){super(e,t),this.friendDiscoveryRequestId=t.friend_discovery_request_id}}class Ce extends e.APIRequestCommand{constructor({userId:t,discoveryKeys:s}){super(),this.method=e.APIRequestMethod.DELETE,this.path=`${e.API_PATH_USERS}/${encodeURIComponent(t)}/friend_discoveries`,this.params={friend_discovery_keys:s}}}class Ee extends e.APIRequestCommand{constructor({userId:t,userIds:s}){super(),this.method=e.APIRequestMethod.POST,this.path=`${e.API_PATH_USERS}/${encodeURIComponent(t)}/friends`,this.params={user_ids:s}}}class Pe extends e.APIResponseCommand{constructor(t,s){super(t,s),this.users=s.users.map((s=>new e.User(t,s)))}}class Te extends e.APIRequestCommand{constructor({userId:t,userIds:s}){super(),this.method=e.APIRequestMethod.DELETE,this.path=`${e.API_PATH_USERS}/${encodeURIComponent(t)}/friends`,this.params={user_ids:s}}}class be extends e.APIRequestCommand{constructor({userId:t}){super(),this.method=e.APIRequestMethod.GET,this.path=`${e.API_PATH_USERS}/${encodeURIComponent(t)}/allow_friend_discovery`,this.params={}}}class Ae extends e.APIResponseCommand{constructor(e,t){super(e,t),this.allowFriendDiscovery=t.allow_friend_discovery}}class we extends e.APIRequestCommand{constructor({userId:t,allowFriendDiscovery:s}){super(),this.method=e.APIRequestMethod.PUT,this.path=`${e.API_PATH_USERS}/${encodeURIComponent(t)}/allow_friend_discovery`,this.params={allow_friend_discovery:s}}}class ke extends e.APIRequestCommand{constructor(){super(),this.method=e.APIRequestMethod.GET,this.path=e.API_PATH_EMOJI_CATEGORIES}}class Oe extends e.APIResponseCommand{constructor(e,t){super(e,t),this.emojiContainer=new u(t)}}class Re extends e.APIRequestCommand{constructor({categoryId:t}){super(),this.method=e.APIRequestMethod.GET,this.path=`${e.API_PATH_EMOJI_CATEGORIES}/${t}`}}class Ne extends e.APIResponseCommand{constructor(e,t){super(e,t),this.emojiCategory=new d(t)}}class Ue extends e.APIRequestCommand{constructor({key:t}){super(),this.method=e.APIRequestMethod.GET,this.path=`${e.API_PATH_EMOJIS}/${t}`}}class De extends e.APIResponseCommand{constructor(e,t){super(e,t),this.emoji=new a(t)}}class Me extends e.APIRequestCommand{constructor(){super(),this.method=e.APIRequestMethod.GET,this.path=`${e.API_PATH_UIKIT_CONFIGURATION}`}}class xe extends e.APIResponseCommand{constructor(e,t){var s;super(e,t);const i=null!=t?t:{};this.uikitConfiguration={string:JSON.stringify(i),json:i},this.updatedAt=null!==(s=null==t?void 0:t.updated_at)&&void 0!==s?s:0}}var Le;!function(e){e.DELIVERED="DELIVERED",e.CLICKED="CLICKED"}(Le||(Le={}));class qe extends e.APIRequestCommand{constructor({deviceToken:t,pushTrackingId:s,messageId:i,allowedPushNotification:n,channelKey:r,templateKey:o,eventType:a,notificationEventDeadline:d}){super(),this.method=e.APIRequestMethod.POST,this.path=e.API_PATH_PUSH_DELIVERY,this.params=e.deundefined({device_token:t,push_tracking_id:s,message_id:i,allowed_push_notification:n,channel_key:r,template_key:o,event_type:a,notification_event_deadline:d})}}let Ve;class $e{constructor(t,s,i){this._storeInitialized=!1,this._iid=t,this.options=s;const{sdkState:o,cacheContext:a,dispatcher:d,sessionManager:u,requestQueue:c,logger:l,userEventHandlers:h,appStateToggleEnabled:p,supportMultipleTabs:_}=e.Vault.of(t);this._onlineDetector=new U({logger:l,connectionDelegate:{reconnect:()=>e.__awaiter(this,void 0,void 0,(function*(){const{sdkState:s,connectionManager:i,sessionManager:n}=e.Vault.of(t);if(n.session.hasSession){if("foreground"===s.appState)try{yield i.resetAndReconnect()}catch(t){if(e.isThrowingOutside(t))throw t;l.debug("resetAndReconnect failed by reconnect event = ",t)}}else try{yield i.connect(n.session.authToken)}catch(t){if(e.isThrowingOutside(t))throw t;l.debug("connect failed by reconnect event = ",t)}d.dispatch(new r.NotificationCollectionRefreshCommand)})),disconnect:()=>{e.runOrNothing((()=>e.__awaiter(this,void 0,void 0,(function*(){const{connectionManager:s,dispatcher:i}=e.Vault.of(t);yield s.disconnect(),i.dispatch(new e.StatLogCommand(new e.StatLog({type:e.StatType.WEBSOCKET_DISCONNECT,data:{success:!0,error_code:e.SendbirdErrorCode.NETWORK_ERROR,error_description:"cause=network_closed"}})))}))))}}});const f=new n.AutoResendManager(t,{localCacheEnabled:a.localCacheEnabled,enableAutoResend:a.localCacheConfig.enableAutoResend,dispatcher:d,sdkState:o,logger:l});i.forEach((e=>{e.init(t,{sdkState:o,cacheContext:a,dispatcher:d,sessionManager:u,requestQueue:c,logger:l,onlineDetector:this._onlineDetector}),this[e.name]=e})),this._appStateChangeDetector=new N({isEnabled:p,supportMultipleTabs:_,localCacheEnabled:a.localCacheEnabled}),this._appStateChangeDetector.on("resume",(()=>{l.debug("the page resumes from freeze"),this.setForegroundState()})).on("pause",(()=>{l.debug("the page freezes"),this.setBackgroundState()})).on("enable_local_cache",(()=>{l.debug("the local cache is enabled because the page is active"),a.localCacheEnabled=!0,this._setAppActiveState(!0),"foreground"===o.appState&&d.dispatch(new n.ForceResumeSyncRequestCommand)})).on("disable_local_cache",(()=>{l.debug("the local cache is disabled because the page is inactive"),a.localCacheEnabled=!1,this._setAppActiveState(!1)})),d.on((s=>{var i;if(s instanceof e.ConnectionStateChangeCommand){if(s.stateType===e.ConnectionStateType.CONNECTED)f.processNonAutoResendRegisteredPendingMessages()}else if(s instanceof e.WebSocketEventCommand)switch(s.code){case"USEV":{const{event:i}=s.as(n.UserEventCommand);switch(i.category){case n.UserEventCategory.FRIEND_DISCOVERED:{const{friendDiscoveries:s}=n.UserEvent.getDataAsFriendDiscoveredEvent(t,i);e.runAsCallback((()=>e.__awaiter(this,void 0,void 0,(function*(){return h.forEach((e=>{e.onFriendsDiscovered&&e.onFriendsDiscovered(s)}))}))));break}}break}}else if(s instanceof e.SubscribedUnreadMessageCountUpdateCommand){const{subscribedUnreadMessageCount:t}=e.Vault.of(this._iid);let i=!1;const n=s.ts;"number"==typeof n&&n>t.ts&&(t.all!==s.all&&(i=!0),t.all=s.all>=0?s.all:0,s.customTypes&&Object.keys(s.customTypes).forEach((e=>{t.customTypes[e]!==s.customTypes[e]&&(i=!0),t.customTypes[e]=s.customTypes[e]})),i=i&&t.ts>0,t.ts=n),i&&e.runAsCallback((()=>e.__awaiter(this,void 0,void 0,(function*(){return h.forEach((e=>{e.onTotalUnreadMessageCountChanged&&e.onTotalUnreadMessageCountChanged({groupChannelCount:t.all,feedChannelCount:t.feed,customTypeUnreadCount:t.customTypes}),e.onTotalUnreadMessageCountUpdated&&e.onTotalUnreadMessageCountUpdated(t.all,t.customTypes)}))}))))}else if(s instanceof e.UserProfileUpdateCommand)a.preference.set(this._getUserProfileCacheKey(o.userId),e.UserProfile.payloadify(s.userProfile)),(null===(i=s.userProfile.appInfo.notificationInfo)||void 0===i?void 0:i.isEnabled)&&a.preference.set(e.createChangelogIncludeChatNotificationsCacheKey(this.appId),{value:!0});else if(s instanceof e.SyncAppConfigsInfoEventCommand)s.configSyncNeeded&&e.runOrNothing((()=>e.__awaiter(this,void 0,void 0,(function*(){yield this._getAppConfigsInfo()}))));else if(s instanceof n.SaveAppConfigsInfoEventCommand)a.preference.set(e.createAppConfigsTsCacheKey(this.appId),{configTs:s.configTs});else if(s instanceof e.SessionExpiredCommand)s.error&&s.error.isSessionInvalidatedError&&(l.debug("session revoked."),this._internalDisconnect(s.error));else if(s instanceof e.AppStateEventCommand)switch(s.event){case"resume":this.setForegroundState();break;case"pause":this.setBackgroundState()}}))}static init(n){const{appId:r,appVersion:o,modules:a=[],options:d=new e.SendbirdChatOptions,debugMode:u=!1,customApiHost:c,customWebSocketHost:l,newInstance:h=!1,logLevel:p,localCacheEnabled:_=!1,localCacheConfig:f=new e.LocalCacheConfig,localCacheEncryption:m,supportMultipleTabs:g=!1,useAsyncStorageStore:v=null,useMMKVStorageStore:y=null,appStateToggleEnabled:S=!0}=n;if(!Ve||h){const n=`su-${e.uuid()}`,h=null!=m?m:{encrypt:e=>e,decrypt:e=>e},I=new i.Logger;I.level=null!=p?p:i.LogLevel.WARN;let C=new i.MemoryStore({encryption:h});u||(e.isReactNative()?y?C=new A({MMKV:y,encryption:h}):v&&(C=new b({AsyncStorage:v,encryption:h}),I.warn("AsyncStorage store is deprecated due to the small size limit. Please use MMKVStorage store instead.")):C=new i.IndexedDbStore({encryption:h})),new e.Vault(n,{appId:r,appVersion:o,options:d,apiHost:null!=c?c:`https://api-${r}.sendbird.com`,websocketHost:null!=l?l:`wss://ws-${r}.sendbird.com`,store:C,encryption:h,logger:I,localCacheEnabled:_,localCacheConfig:f,debugMode:u,appStateToggleEnabled:S,supportMultipleTabs:g});const E=[new t.MessageModule,new s.PollModule],P=new $e(n,d,[...a,...E]);return Ve||(Ve=P),P}return Ve}static get instance(){return Ve}static get version(){return e.version}get appId(){const{sdkState:t}=e.Vault.of(this._iid);return t.appId}get appInfo(){const{appInfo:t}=e.Vault.of(this._iid);return null!=t?t:null}get appVersion(){var t;const{sdkState:s}=e.Vault.of(this._iid);return null!==(t=s.appVersion)&&void 0!==t?t:""}get debugMode(){const{debugMode:t}=e.Vault.of(this._iid);return!!t}get logLevel(){const{logger:t}=e.Vault.of(this._iid);return t.level}set logLevel(t){const{logger:s}=e.Vault.of(this._iid);s.level=t}get isCacheEnabled(){const{cacheContext:t}=e.Vault.of(this._iid);return t.localCacheEnabled}get localCacheConfig(){const{cacheContext:t}=e.Vault.of(this._iid);return t.localCacheEnabled?t.localCacheConfig:null}get ekey(){const{sessionManager:t}=e.Vault.of(this._iid);return t.ekey}get currentUser(){var t;const{sessionManager:s}=e.Vault.of(this._iid);return null!==(t=s.currentUser)&&void 0!==t?t:null}get connectionState(){const{connectionManager:t}=e.Vault.of(this._iid);return t.isConnected?e.ConnectionState.OPEN:t.isConnecting?e.ConnectionState.CONNECTING:e.ConnectionState.CLOSED}get lastConnectedAt(){const{connectedAt:t,connectionManager:s}=e.Vault.of(this._iid);return s.isConnected?t:0}get fcmPushToken(){var e;return null!==(e=this._fcmPushToken)&&void 0!==e?e:null}get apnsPushToken(){var e;return null!==(e=this._apnsPushToken)&&void 0!==e?e:null}_getNestDBVersion(){return 8}_getPreferenceVersion(){return 9}_getPreferenceCacheKey(e){return`sendbird@${this.appId}/${e}.pref`}_getUserProfileCacheKey(e){return`sendbird@${this.appId}/${e}.profile`}_internalDisconnect(t){return e.__awaiter(this,void 0,void 0,(function*(){const{connectionManager:s,sdkState:i,requestQueue:n}=e.Vault.of(this._iid);this._appStateChangeDetector.stop(),this._onlineDetector.stop(),n.cancelAll(),yield s.logout(t),yield this.clearCachedData(),i.appState="foreground",i.isAppActive=!1}))}_getAppConfigsInfo(){return e.__awaiter(this,void 0,void 0,(function*(){const{requestQueue:t,dispatcher:s,cacheContext:i,sdkState:r}=e.Vault.of(this._iid),o={};let a;const d=yield i.preference.get(e.createAppConfigsTsCacheKey(r.appId));d&&(a=d.configTs),new n.Sync("appConfigsInfo",(i=>e.__awaiter(this,void 0,void 0,(function*(){const e={hasNext:!0,nextToken:i},r=new D({token:i}),a=yield t.send(r),{configs:d,hasMore:u,nextToken:c,ts:l}=a.as(M);return Object.keys(d).forEach((e=>{o[e]=d[e]})),e.hasNext=u,e.nextToken=c,u||s.dispatch(new n.ApplyAppConfigsInfoEventCommand({appConfigsInfo:o,configTs:l})),e})))).start(a)}))}getMemoryStoreForDebugging(){const{debugMode:t,cacheContext:s}=e.Vault.of(this._iid);if(t)return s.store instanceof i.MemoryStore?s.store:null;throw e.SendbirdError.debugModeRequired}addExtension(t,s){const{sdkState:i}=e.Vault.of(this._iid);["sb_uikit","sb_syncmanager","device-os-platform"].indexOf(t)>-1&&i.extensions&&(i.extensions[t]=s)}addSendbirdExtensions(t,s,i){const{logger:n,sdkState:r}=e.Vault.of(this._iid),o=new RegExp(e.SEMVER_REGEX_STRING);if(0===t.length)return n.debug("sb.addSendbirdExtensions() has failed because the given sendbirdExtensions is empty."),!1;if(t.find((e=>!o.test(e.version))))return n.debug("sb.addSendbirdExtensions() has failed because the given version did not satisfy the SemVer specification."),!1;if(i)for(const[e,t]of Object.entries(i))if(/&|=/.test(e)||/&|=/.test(t))return n.debug("sb.addSendbirdExtensions() has failed because the given customData includes at least one invalid character: = or &."),!1;return r.sendbirdRuntimeEnvironment={sendbirdExtensions:t,deviceOS:s,customData:i},!0}setOnlineListener(e){this._onlineDetector.setOnlineListener(e)}setOfflineListener(e){this._onlineDetector.setOfflineListener(e)}_safeInitializeStore(t){return e.__awaiter(this,void 0,void 0,(function*(){const{cacheContext:s}=e.Vault.of(this._iid);try{yield s.store.init(t),this._storeInitialized=!0}catch(e){s.replaceStore(new i.MemoryStore),yield this._safeInitializeStore(t)}}))}initializeCache(t){return e.__awaiter(this,void 0,void 0,(function*(){const{sdkState:s,cacheContext:r,dispatcher:o,logger:a}=e.Vault.of(this._iid);if(!s.userId||s.userId!==t){const d=`sendbird@${s.appId}/${t}.db`;try{if(r.localCacheEnabled){if(r.nestdb&&r.nestdb.state!==i.NestDBState.CLOSED&&r.nestdb.name===d)yield this._safeInitializeStore(d);else{const e=`sendbird@${s.appId}/${t}.db`,a=r.nestdb=new i.NestDB({name:e,version:this._getNestDBVersion(),store:r.store,config:new i.Config({dbname:e,cacheLimit:64,itemSizeLimit:61440})});a.on("upgrade",O(a)),a.on("storeReplaced",(e=>{r.replaceStore(e),r.localCacheEnabled=!1,a.on("upgrade",O(a))})),yield a.open(),this._storeInitialized=!0,o.dispatch(new n.DatabaseOpenCommand(this._iid,{userId:t}))}s.userId=t}else yield this._safeInitializeStore(d),s.userId=t}catch(n){throw a.warn("Nest DB Open Failed. ",n),r.store instanceof i.MemoryStore||(r.replaceStore(new i.MemoryStore),r.localCacheEnabled=!1),yield this._safeInitializeStore(d),s.userId=t,e.SendbirdError.databaseError}finally{yield this._setupPreference(t)}}}))}getCacheDataSize(){return e.__awaiter(this,void 0,void 0,(function*(){const{cacheContext:t}=e.Vault.of(this._iid);return t.localCacheEnabled&&t.nestdb?yield t.nestdb.estimateUsage():0}))}clearCachedData(){return e.__awaiter(this,void 0,void 0,(function*(){const{cacheContext:t}=e.Vault.of(this._iid);t.localCacheEnabled&&t.nestdb&&(yield t.nestdb.clear()),this._storeInitialized&&(yield t.preference.clear())}))}clearCachedMessages(t){return e.__awaiter(this,void 0,void 0,(function*(){e.unless(e.isArrayOf("string",t)).throw(e.SendbirdError.invalidParameters);const s=i.MessageCache.of(this._iid),n=i.UnsentMessageCache.of(this._iid);s&&n&&(yield Promise.all(t.map((t=>e.__awaiter(this,void 0,void 0,(function*(){yield s.removeMessagesOfChannel(t),yield n.removeMessagesOfChannel(t)}))))))}))}_setupPreference(t){return e.__awaiter(this,void 0,void 0,(function*(){const{sdkState:s,cacheContext:i,statManager:n}=e.Vault.of(this._iid);yield i.preference.init(this._getPreferenceCacheKey(t),this._getPreferenceVersion());const r=yield i.preference.get(this._getUserProfileCacheKey(t));if(r){new e.UserProfile(this._iid,r).apply()}yield n.init(`sendbird@${s.appId}/${t}.statlog`)}))}_ready(t,s,i={}){return e.__awaiter(this,void 0,void 0,(function*(){e.unless(e.isTypeOf("string",t)&&e.isTypeOf("string",s,!0)).throw(e.SendbirdError.invalidParameters);const{sdkState:r,cacheContext:o,connectionManager:a}=e.Vault.of(this._iid),{errorForOtherUser:d}=i;if(r.userId&&r.userId!==t){if(d)throw d;yield a.logout()}try{yield this.initializeCache(t);const{dispatcher:s}=e.Vault.of(this._iid);s.dispatch(new n.ReduceDBSizeEventCommand)}catch(t){const{logger:s}=e.Vault.of(this._iid);o.localCacheEnabled=!1,s.warn("Cache initialization failed - cache is not available.")}}))}authenticateFeed(t,s){return e.__awaiter(this,void 0,void 0,(function*(){return yield this.authenticate(t,s)}))}authenticate(t,s,i=e.AuthTokenType.SESSION_TOKEN){var n;return e.__awaiter(this,void 0,void 0,(function*(){const{sessionManager:r,connectionManager:o}=e.Vault.of(this._iid);return yield this._ready(t,s,{errorForOtherUser:o.isConnected?e.SendbirdError.alreadyConnectedAsAnotherUser:void 0}),(null===(n=r.session.services)||void 0===n?void 0:n.includes(e.SessionService.CHAT))||(r.handler||s&&i!==e.AuthTokenType.ACCESS_TOKEN||this.setSessionHandler(new p),yield r.authenticate(t,s)),this.currentUser}))}connect(t,s){var i;return e.__awaiter(this,void 0,void 0,(function*(){yield this._ready(t,s);try{const{connectionManager:t}=e.Vault.of(this._iid);yield t.connect(s)}finally{this._onlineDetector.start(),this._appStateChangeDetector.start({appId:this.appId,userId:t,backgroundConnectionCloseTimeout:null===(i=this.appInfo)||void 0===i?void 0:i.backgroundConnectionCloseTimeout})}return this.currentUser}))}reconnect(){const{connectionManager:t,sdkState:s,sessionManager:i,dispatcher:n}=e.Vault.of(this._iid),r=i.session.hasSession;return r&&(n.dispatch(new e.StatLogCommand(new e.StatLog({type:e.StatType.WEBSOCKET_DISCONNECT,data:{success:!0,error_code:0,error_description:"cause=explicit_reconnect"}}))),this._appStateChangeDetector.start({appId:this.appId,userId:this.currentUser.userId,backgroundConnectionCloseTimeout:this.appInfo.backgroundConnectionCloseTimeout}),this._onlineDetector.start(),t.resetAndReconnect().then((()=>{s.appState="foreground"})).catch((()=>{}))),r}disconnect(){return e.__awaiter(this,void 0,void 0,(function*(){yield this._internalDisconnect()}))}disconnectWebSocket(){return e.__awaiter(this,void 0,void 0,(function*(){const{connectionManager:t,requestQueue:s,dispatcher:i}=e.Vault.of(this._iid);i.dispatch(new e.StatLogCommand(new e.StatLog({type:e.StatType.WEBSOCKET_DISCONNECT,data:{success:!0,error_code:0,error_description:"cause=explicit_disconnect_websocket"}}))),this._appStateChangeDetector.stop(),this._onlineDetector.stop(),s.cancelAll(),yield t.disconnectWebSocket(!0)}))}setBackgroundState(){const{connectionManager:t,sdkState:s,logger:i,dispatcher:n}=e.Vault.of(this._iid);"foreground"===s.appState&&(s.appState="background",s.isAppActive=!1,i.debug("going background state"),n.dispatch(new e.StatLogCommand(new e.StatLog({type:e.StatType.WEBSOCKET_DISCONNECT,data:{success:!0,error_code:e.SendbirdErrorCode.WEBSOCKET_CONNECTION_CLOSED,error_description:"cause=background"}}))),t.background().catch((e=>{i.debug("setBackgroundState error = ",e)})))}setForegroundState(){const{connectionManager:t,sdkState:s,dispatcher:i,logger:n}=e.Vault.of(this._iid);"background"===s.appState&&(s.appState="foreground",s.isAppActive=!0,n.debug("going foreground state"),t.resetAndReconnect().catch((e=>{n.debug("setForgroundState error = ",e)})),i.dispatch(new r.NotificationCollectionRefreshCommand))}_setAppActiveState(t){const{sdkState:s}=e.Vault.of(this._iid);s.isAppActive=t}setSessionHandler(t){e.unless(t instanceof p).throw(e.SendbirdError.invalidParameters);const{sessionManager:s}=e.Vault.of(this._iid);s.handler=t}addUserEventHandler(t,s){e.unless(e.isTypeOf("string",t)&&s instanceof f).throw(e.SendbirdError.invalidParameters);const{userEventHandlers:i}=e.Vault.of(this._iid);i.set(t,s)}removeUserEventHandler(t){const{userEventHandlers:s}=e.Vault.of(this._iid);s.delete(t)}removeAllUserEventHandler(){const{userEventHandlers:t}=e.Vault.of(this._iid);t.clear()}addConnectionHandler(t,s){e.unless(e.isTypeOf("string",t)&&s instanceof l).throw(e.SendbirdError.invalidParameters);const{connectionHandlers:i}=e.Vault.of(this._iid);i.set(t,s)}removeConnectionHandler(t){const{connectionHandlers:s}=e.Vault.of(this._iid);s.delete(t)}removeAllConnectionHandler(){const{connectionHandlers:t}=e.Vault.of(this._iid);t.clear()}createApplicationUserListQuery(e={}){return new v(this._iid,e)}createBlockedUserListQuery(e={}){return new I(this._iid,e)}createFriendListQuery(e={}){return new P(this._iid,e)}createMessageSearchQuery(e){return new i.MessageSearchQuery(this._iid,e)}createPollListQuery(t){return new e.PollListQuery(this._iid,Object.assign({},t))}createPollVoterListQuery(t){return new e.PollVoterListQuery(this._iid,Object.assign({},t))}buildUserFromSerializedData(t){const s=e.deserialize(t);return new e.User(this._iid,e.User.payloadify(s))}updateCurrentUserInfo(t={}){return e.__awaiter(this,void 0,void 0,(function*(){const s=Object.assign(Object.assign({},w),t);if(e.unless((t=>e.isFile(t.profileImage,!0)&&e.isTypeOf("string",t.profileUrl,!0)&&e.isTypeOf("string",t.nickname,!0))(s)).throw(e.SendbirdError.invalidParameters),this.currentUser){const{sdkState:t,requestQueue:i}=e.Vault.of(this._iid),n=new x(Object.assign({userId:t.userId},s)),r=yield i.send(n),{user:o}=r.as(L);return this.currentUser&&(s.nickname&&(this.currentUser.nickname=o.nickname),(s.profileUrl||s.profileImage)&&(this.currentUser.plainProfileUrl=o.profileUrl)),o}throw e.SendbirdError.connectionRequired}))}updateCurrentUserInfoWithPreferredLanguages(t){return e.__awaiter(this,void 0,void 0,(function*(){if(e.unless(e.isArrayOf("string",t)).throw(e.SendbirdError.invalidParameters),this.currentUser){const{sdkState:s,requestQueue:i}=e.Vault.of(this._iid),n=new x({userId:s.userId,preferredLanguages:t}),r=yield i.send(n),{user:o}=r.as(L);return this.currentUser&&(this.currentUser.preferredLanguages=o.preferredLanguages),o}throw e.SendbirdError.connectionRequired}))}registerFCMPushTokenForCurrentUser(t,s){var i,n;return e.__awaiter(this,void 0,void 0,(function*(){if(e.unless(e.isTypeOf("string",t)&&e.isTypeOf("string",null==s?void 0:s.deviceManufacturer,!0)).throw(e.SendbirdError.invalidParameters),(null==s?void 0:s.deviceOS)&&e.unless(e.isEnumOf(e.DeviceOsPlatform,s.deviceOS.platform,!0)&&e.isTypeOf("string",s.deviceOS.version,!0)).throw(e.SendbirdError.invalidParameters),!this.currentUser)return this._fcmPushToken=t,e.PushTokenRegistrationState.PENDING;{const r={deviceOS:`${(null===(i=null==s?void 0:s.deviceOS)||void 0===i?void 0:i.platform)||e.DeviceOsPlatform.ANDROID}-${(null===(n=null==s?void 0:s.deviceOS)||void 0===n?void 0:n.version)||"unknown"}`,deviceManufacturer:null==s?void 0:s.deviceManufacturer,systemPushEnabled:null==s?void 0:s.systemPushEnabled};try{const{sessionManager:s,sdkState:i,requestQueue:n}=e.Vault.of(this._iid);if(s.hasDeviceToken(e.PushTokenType.FCM,t))return e.PushTokenRegistrationState.SUCCESS;const o=new V({userId:i.userId,token:t,deviceOS:r.deviceOS,deviceManufacturer:r.deviceManufacturer,systemPushEnabled:r.systemPushEnabled});return yield n.send(o),yield e.runOrNothing((()=>e.__awaiter(this,void 0,void 0,(function*(){s.setDeviceToken(e.PushTokenType.FCM,t,r),yield s.saveDeviceToken()})))),this._fcmPushToken="",e.PushTokenRegistrationState.SUCCESS}catch(t){return e.PushTokenRegistrationState.ERROR}}}))}unregisterFCMPushTokenForCurrentUser(t){return e.__awaiter(this,void 0,void 0,(function*(){if(e.unless(e.isTypeOf("string",t)).throw(e.SendbirdError.invalidParameters),!this.currentUser)return this._fcmPushToken=t,e.PushTokenRegistrationState.PENDING;try{const{sessionManager:s,sdkState:i,requestQueue:n}=e.Vault.of(this._iid),r=new K({userId:i.userId,token:t}),o=yield n.send(r),{lastDeletedAt:a}=o.as(H);return yield e.runOrNothing((()=>e.__awaiter(this,void 0,void 0,(function*(){s.unsetDeviceToken(e.PushTokenType.FCM,t),s.setDeviceTokenDeletedAt(a),yield s.saveDeviceToken()})))),this._fcmPushToken="",e.PushTokenRegistrationState.SUCCESS}catch(t){return e.PushTokenRegistrationState.ERROR}}))}unregisterFCMPushTokenAllForCurrentUser(){return e.__awaiter(this,void 0,void 0,(function*(){if(this.currentUser){const{sessionManager:t,sdkState:s,requestQueue:i}=e.Vault.of(this._iid),n=new Q({userId:s.userId}),r=yield i.send(n),{lastDeletedAt:o}=r.as(z);yield e.runOrNothing((()=>e.__awaiter(this,void 0,void 0,(function*(){t.unsetDeviceTokens(e.PushTokenType.FCM),t.setDeviceTokenDeletedAt(o),yield t.saveDeviceToken()}))))}}))}registerAPNSPushTokenForCurrentUser(t,s){var i,n;return e.__awaiter(this,void 0,void 0,(function*(){if(e.unless(e.isTypeOf("string",t)&&e.isTypeOf("string",null==s?void 0:s.deviceManufacturer,!0)).throw(e.SendbirdError.invalidParameters),(null==s?void 0:s.deviceOS)&&e.unless(e.isEnumOf(e.DeviceOsPlatform,s.deviceOS.platform,!0)&&e.isTypeOf("string",s.deviceOS.version,!0)).throw(e.SendbirdError.invalidParameters),!this.currentUser)return this._apnsPushToken=t,e.PushTokenRegistrationState.PENDING;{const r={deviceOS:`${(null===(i=null==s?void 0:s.deviceOS)||void 0===i?void 0:i.platform)||e.DeviceOsPlatform.IOS}-${(null===(n=null==s?void 0:s.deviceOS)||void 0===n?void 0:n.version)||"unknown"}`,deviceManufacturer:null==s?void 0:s.deviceManufacturer,systemPushEnabled:null==s?void 0:s.systemPushEnabled};try{const{sessionManager:s,sdkState:i,requestQueue:n}=e.Vault.of(this._iid);if(s.hasDeviceToken(e.PushTokenType.APNS,t))return e.PushTokenRegistrationState.SUCCESS;const o=new q({userId:i.userId,token:t,deviceOS:r.deviceOS,deviceManufacturer:r.deviceManufacturer,systemPushEnabled:r.systemPushEnabled});return yield n.send(o),yield e.runOrNothing((()=>e.__awaiter(this,void 0,void 0,(function*(){s.setDeviceToken(e.PushTokenType.APNS,t,r),yield s.saveDeviceToken()})))),this._apnsPushToken="",e.PushTokenRegistrationState.SUCCESS}catch(t){return e.PushTokenRegistrationState.ERROR}}}))}unregisterAPNSPushTokenForCurrentUser(t){return e.__awaiter(this,void 0,void 0,(function*(){if(e.unless(e.isTypeOf("string",t)).throw(e.SendbirdError.invalidParameters),!this.currentUser)return this._apnsPushToken=t,e.PushTokenRegistrationState.PENDING;try{const{sessionManager:s,sdkState:i,requestQueue:n}=e.Vault.of(this._iid),r=new $({userId:i.userId,token:t}),o=yield n.send(r),{lastDeletedAt:a}=o.as(F);return yield e.runOrNothing((()=>e.__awaiter(this,void 0,void 0,(function*(){s.unsetDeviceToken(e.PushTokenType.APNS,t),s.setDeviceTokenDeletedAt(a),yield s.saveDeviceToken()})))),this._apnsPushToken="",e.PushTokenRegistrationState.SUCCESS}catch(t){return e.PushTokenRegistrationState.ERROR}}))}unregisterAPNSPushTokenAllForCurrentUser(){return e.__awaiter(this,void 0,void 0,(function*(){if(this.currentUser){const{sessionManager:t,sdkState:s,requestQueue:i}=e.Vault.of(this._iid),n=new j({userId:s.userId}),r=yield i.send(n),{lastDeletedAt:o}=r.as(B);yield e.runOrNothing((()=>e.__awaiter(this,void 0,void 0,(function*(){t.unsetDeviceTokens(e.PushTokenType.APNS),t.setDeviceTokenDeletedAt(o),yield t.saveDeviceToken()}))))}}))}markPushNotificationAsDelivered(t,s=!0){var i;return e.__awaiter(this,void 0,void 0,(function*(){const{logger:n,sessionManager:r,requestQueue:o,pushNotificationAckManager:a}=e.Vault.of(this._iid);n.debug("markPushNotificationAsDelivered:",t);const d=Le.DELIVERED,{pushTrackingId:u,sessionTopics:c,sessionKey:l,messageId:h,channelKey:p,templateKey:_,notificationEventDeadline:f}=a.parseData(t);if(!l)throw n.info("Can't use markPushNotificationAsDelivered() feature."),e.SendbirdError.malformedDataError;if(!c.includes(e.PushSessionKeyTopic.PUSH_ACKNOWLEDGEMENT))throw n.info("Can't use markPushNotificationAsDelivered() feature."),e.SendbirdError.malformedDataError;if(a.isAcked(u,d))return void n.info("already delivered push notification:",u);const m=Boolean(p),g=s&&m,v=null===(i=r.deviceTokens[0])||void 0===i?void 0:i.token,y=new qe({deviceToken:null!=v?v:"",pushTrackingId:u,eventType:d,messageId:h,channelKey:p,templateKey:_,notificationEventDeadline:f,allowedPushNotification:g});l&&(y.headers["Session-Key"]=l);try{yield o.send(y),a.markAsAcked(u,d)}catch(e){throw n.debug(`failed to mark push notification as delivered. push tracking id: ${u}. error: ${e}`),e}}))}markPushNotificationAsClicked(t){var s;return e.__awaiter(this,void 0,void 0,(function*(){const{logger:i,sessionManager:n,requestQueue:r,pushNotificationAckManager:o}=e.Vault.of(this._iid);i.debug("markPushNotificationAsClicked:",t);const a=Le.CLICKED,{pushTrackingId:d,sessionTopics:u,sessionKey:c,messageId:l,channelKey:h,templateKey:p,notificationEventDeadline:_}=o.parseData(t);if(!c)throw i.info("Can't use markPushNotificationAsClicked() feature."),e.SendbirdError.malformedDataError;if(!u.includes(e.PushSessionKeyTopic.PUSH_ACKNOWLEDGEMENT))throw i.info("Can't use markPushNotificationAsClicked() feature."),e.SendbirdError.malformedDataError;if(o.isAcked(d,a))return void i.info("already clicked push notification:",d);const f=null===(s=n.deviceTokens[0])||void 0===s?void 0:s.token,m=new qe({deviceToken:null!=f?f:"",pushTrackingId:d,eventType:a,messageId:l,channelKey:h,templateKey:p,notificationEventDeadline:_});c&&(m.headers["Session-Key"]=c);try{yield r.send(m),o.markAsAcked(d,a)}catch(e){throw i.debug(`failed to mark push notification as clicked. push tracking id: ${d}. error: ${e}`),e}}))}getChannelInvitationPreference(){return e.__awaiter(this,void 0,void 0,(function*(){const{sdkState:t,requestQueue:s}=e.Vault.of(this._iid),i=new J({userId:t.userId}),n=yield s.send(i),{autoAccept:r}=n.as(Y);return{autoAccept:r}}))}setChannelInvitationPreference(t){return e.__awaiter(this,void 0,void 0,(function*(){e.unless(e.isTypeOf("boolean",t)).throw(e.SendbirdError.invalidParameters);const{sdkState:s,requestQueue:i}=e.Vault.of(this._iid),n=new X({userId:s.userId,willAutoAccept:t}),r=yield i.send(n),{autoAccept:o}=r.as(Z);return{autoAccept:o}}))}getDoNotDisturb(){return e.__awaiter(this,void 0,void 0,(function*(){const{sdkState:t,requestQueue:s}=e.Vault.of(this._iid),i=new ee({userId:t.userId}),n=yield s.send(i),{preference:r}=n.as(te);return r}))}setDoNotDisturb(t,s=0,i=0,n=0,r=0,o=""){return e.__awaiter(this,void 0,void 0,(function*(){e.unless(e.isTypeOf("boolean",t)&&e.isTypeOf("number",s)&&e.isTypeOf("number",i)&&e.isTypeOf("number",n)&&e.isTypeOf("number",r)&&e.isTypeOf("string",o)).throw(e.SendbirdError.invalidParameters);const{sdkState:a,requestQueue:d}=e.Vault.of(this._iid),u=new se({userId:a.userId,doNotDisturbOn:t,startHour:s,startMin:i,endHour:n,endMin:r,timezone:o}),c=yield d.send(u),{preference:l}=c.as(ie);return l}))}getSnoozePeriod(){return e.__awaiter(this,void 0,void 0,(function*(){const{sdkState:t,requestQueue:s}=e.Vault.of(this._iid),i=new ne({userId:t.userId}),n=yield s.send(i),{snoozePeriod:r}=n.as(re);return r}))}setSnoozePeriod(t,s=0,i=0){return e.__awaiter(this,void 0,void 0,(function*(){e.unless(e.isTypeOf("boolean",t)&&e.isTypeOf("number",s)&&e.isTypeOf("number",i)).throw(e.SendbirdError.invalidParameters);const{sdkState:n,requestQueue:r}=e.Vault.of(this._iid),o=new oe({userId:n.userId,snoozeOn:t,startTs:s,endTs:i}),a=yield r.send(o),{snoozePeriod:d}=a.as(ae);return d}))}getMyPushTokensByToken(t,s){return e.__awaiter(this,void 0,void 0,(function*(){e.unless(e.isTypeOf("string",t)&&e.isEnumOf(e.PushTokenType,s)).throw(e.SendbirdError.invalidParameters);const{sdkState:i,requestQueue:n,sessionManager:r}=e.Vault.of(this._iid),o=new G({userId:i.userId,type:s,token:t}),a=yield n.send(o),{pushTokens:d}=a.as(W);for(const e of d.deviceTokens)r.setDeviceToken(d.type,e);return yield r.saveDeviceToken(),d}))}getPushTriggerOption(){return e.__awaiter(this,void 0,void 0,(function*(){const{sdkState:t,requestQueue:s}=e.Vault.of(this._iid),i=new ce({userId:t.userId});return(yield s.send(i)).as(le).pushTriggerOption}))}setPushTriggerOption(t){return e.__awaiter(this,void 0,void 0,(function*(){e.unless(e.isEnumOf(e.PushTriggerOption,t)).throw(e.SendbirdError.invalidParameters);const{sdkState:s,requestQueue:i}=e.Vault.of(this._iid),n=new he({userId:s.userId,pushTriggerOption:t});return(yield i.send(n)).as(pe).pushTriggerOption}))}getPushTemplate(){return e.__awaiter(this,void 0,void 0,(function*(){const{sdkState:t,requestQueue:s}=e.Vault.of(this._iid),i=new _e({userId:t.userId});return(yield s.send(i)).as(fe).name}))}setPushTemplate(t){return e.__awaiter(this,void 0,void 0,(function*(){e.unless(e.isEnumOf(e.PushTemplate,t)).throw(e.SendbirdError.invalidParameters);const{sdkState:s,requestQueue:i}=e.Vault.of(this._iid),n=new me({userId:s.userId,templateName:t});return(yield i.send(n)).as(ge).name}))}blockUser(t){return e.__awaiter(this,void 0,void 0,(function*(){e.unless(t instanceof e.User||e.isTypeOf("string",t)).throw(e.SendbirdError.invalidParameters);const{sdkState:s,requestQueue:i}=e.Vault.of(this._iid),n=new de({userId:s.userId,blockedUserId:t instanceof e.User?t.userId:t});yield i.send(n)}))}blockUserWithUserId(t){return e.__awaiter(this,void 0,void 0,(function*(){return this.blockUser(t)}))}unblockUser(t){return e.__awaiter(this,void 0,void 0,(function*(){e.unless(t instanceof e.User||e.isTypeOf("string",t)).throw(e.SendbirdError.invalidParameters);const{sdkState:s,requestQueue:i}=e.Vault.of(this._iid),n=new ue({userId:s.userId,unblockedUserId:t instanceof e.User?t.userId:t});yield i.send(n)}))}unblockUserWithUserId(t){return e.__awaiter(this,void 0,void 0,(function*(){return this.unblockUser(t)}))}getFriendChangeLogsByToken(t){return e.__awaiter(this,void 0,void 0,(function*(){e.unless(e.isTypeOf("string",t)).throw(e.SendbirdError.invalidParameters);const{sdkState:s,requestQueue:i}=e.Vault.of(this._iid),n=new ve({userId:s.userId,token:t}),r=yield i.send(n),{changelogs:o}=r.as(ye);return o}))}getAllowFriendDiscovery(){return e.__awaiter(this,void 0,void 0,(function*(){const{sdkState:t,requestQueue:s}=e.Vault.of(this._iid),i=new be({userId:t.userId}),n=yield s.send(i),{allowFriendDiscovery:r}=n.as(Ae);return r}))}setAllowFriendDiscovery(t){return e.__awaiter(this,void 0,void 0,(function*(){e.unless(e.isTypeOf("boolean",t)).throw(e.SendbirdError.invalidParameters);const{sdkState:s,requestQueue:i}=e.Vault.of(this._iid),n=new we({userId:s.userId,allowFriendDiscovery:t});return yield i.send(n),t}))}uploadFriendDiscoveries(t){return e.__awaiter(this,void 0,void 0,(function*(){const{sdkState:s,requestQueue:i}=e.Vault.of(this._iid),n=new Se({userId:s.userId,discoveries:t}),r=yield i.send(n),{friendDiscoveryRequestId:o}=r.as(Ie);return o}))}deleteFriendDiscovery(t){return e.__awaiter(this,void 0,void 0,(function*(){return this.deleteFriendDiscoveries([t])}))}deleteFriendDiscoveries(t){return e.__awaiter(this,void 0,void 0,(function*(){e.unless(e.isArrayOf("string",t)).throw(e.SendbirdError.invalidParameters);const{sdkState:s,requestQueue:i}=e.Vault.of(this._iid),n=new Ce({userId:s.userId,discoveryKeys:t});yield i.send(n)}))}addFriends(t){return e.__awaiter(this,void 0,void 0,(function*(){e.unless(e.isArrayOf("string",t)).throw(e.SendbirdError.invalidParameters);const{sdkState:s,requestQueue:i}=e.Vault.of(this._iid),n=new Ee({userId:s.userId,userIds:t}),r=yield i.send(n),{users:o}=r.as(Pe);return o}))}deleteFriend(t){return e.__awaiter(this,void 0,void 0,(function*(){return this.deleteFriends([t])}))}deleteFriends(t){return e.__awaiter(this,void 0,void 0,(function*(){e.unless(e.isArrayOf("string",t)).throw(e.SendbirdError.invalidParameters);const{sdkState:s,requestQueue:i}=e.Vault.of(this._iid),n=new Te({userId:s.userId,userIds:t});yield i.send(n)}))}getAllEmoji(){return e.__awaiter(this,void 0,void 0,(function*(){const{requestQueue:t}=e.Vault.of(this._iid),s=new ke,i=yield t.send(s),{emojiContainer:n}=i.as(Oe);return n}))}getEmojiCategory(t){return e.__awaiter(this,void 0,void 0,(function*(){const{requestQueue:s}=e.Vault.of(this._iid),i=new Re({categoryId:t}),n=yield s.send(i),{emojiCategory:r}=n.as(Ne);return r}))}getEmoji(t){return e.__awaiter(this,void 0,void 0,(function*(){const{requestQueue:s}=e.Vault.of(this._iid),i=new Ue({key:t}),n=yield s.send(i),{emoji:r}=n.as(De);return r}))}getUIKitConfiguration(){return e.__awaiter(this,void 0,void 0,(function*(){const t=e.Vault.of(this._iid);e.unless(t.hasExtension("sb_uikit")).throw(e.SendbirdError.notSupportedError);const{requestQueue:s}=t,i=new Me,n=yield s.send(i),{uikitConfiguration:r}=n.as(xe);return r}))}getReportCategoryInfoList(){return e.__awaiter(this,void 0,void 0,(function*(){const{reportCategoryManager:t}=e.Vault.of(this._iid);return yield t.categories()}))}}exports.AppInfo=e.AppInfo,Object.defineProperty(exports,"AuthTokenType",{enumerable:!0,get:function(){return e.AuthTokenType}}),exports.CachedChannelInfo=e.CachedChannelInfo,Object.defineProperty(exports,"CachedDataClearOrder",{enumerable:!0,get:function(){return e.CachedDataClearOrder}}),Object.defineProperty(exports,"ChannelType",{enumerable:!0,get:function(){return e.ChannelType}}),Object.defineProperty(exports,"CollectionEventSource",{enumerable:!0,get:function(){return e.CollectionEventSource}}),Object.defineProperty(exports,"ConnectionState",{enumerable:!0,get:function(){return e.ConnectionState}}),Object.defineProperty(exports,"DeviceOsPlatform",{enumerable:!0,get:function(){return e.DeviceOsPlatform}}),Object.defineProperty(exports,"LastMessageThreadingPolicy",{enumerable:!0,get:function(){return e.LastMessageThreadingPolicy}}),exports.LocalCacheConfig=e.LocalCacheConfig,exports.NotificationInfo=e.NotificationInfo,Object.defineProperty(exports,"PushTemplate",{enumerable:!0,get:function(){return e.PushTemplate}}),Object.defineProperty(exports,"PushTokenRegistrationState",{enumerable:!0,get:function(){return e.PushTokenRegistrationState}}),Object.defineProperty(exports,"PushTokenType",{enumerable:!0,get:function(){return e.PushTokenType}}),Object.defineProperty(exports,"PushTriggerOption",{enumerable:!0,get:function(){return e.PushTriggerOption}}),exports.ReportCategoryInfo=e.ReportCategoryInfo,Object.defineProperty(exports,"Role",{enumerable:!0,get:function(){return e.Role}}),exports.SendbirdChatOptions=e.SendbirdChatOptions,exports.SendbirdError=e.SendbirdError,Object.defineProperty(exports,"SendbirdErrorCode",{enumerable:!0,get:function(){return e.SendbirdErrorCode}}),Object.defineProperty(exports,"SendbirdPlatform",{enumerable:!0,get:function(){return e.SendbirdPlatform}}),Object.defineProperty(exports,"SendbirdProduct",{enumerable:!0,get:function(){return e.SendbirdProduct}}),exports.UIKitConfigInfo=e.UIKitConfigInfo,Object.defineProperty(exports,"UnreadCountThreadingPolicy",{enumerable:!0,get:function(){return e.UnreadCountThreadingPolicy}}),exports.User=e.User,Object.defineProperty(exports,"UserOnlineState",{enumerable:!0,get:function(){return e.UserOnlineState}}),exports.BannedUserListQuery=i.BannedUserListQuery,exports.BaseChannel=i.BaseChannel,Object.defineProperty(exports,"LogLevel",{enumerable:!0,get:function(){return i.LogLevel}}),exports.MemoryStore=i.MemoryStore,exports.MutedUserListQuery=i.MutedUserListQuery,exports.OperatorListQuery=i.OperatorListQuery,exports.Plugin=i.Plugin,Object.defineProperty(exports,"ReportCategory",{enumerable:!0,get:function(){return i.ReportCategory}}),exports.RestrictedUser=i.RestrictedUser,exports.RestrictionInfo=i.RestrictionInfo,Object.defineProperty(exports,"RestrictionType",{enumerable:!0,get:function(){return i.RestrictionType}}),exports.Participant=o.Participant,exports.ApplicationUserListQuery=v,exports.BlockedUserListQuery=I,exports.ConnectionHandler=l,exports.Emoji=a,exports.EmojiCategory=d,exports.EmojiContainer=u,exports.FriendListQuery=P,exports.SessionHandler=p,exports.UserEventHandler=f,exports.default=$e;
