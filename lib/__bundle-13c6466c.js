import{V as e,r,h as t,K as s,bh as n,as as a,bi as o,aq as d}from"./__bundle-fa3d315f.js";var i=function(i,u){return new Promise((function(p,f){if("undefined"!=typeof XMLHttpRequest){var c=e.of(i),l=c.dispatcher,h=c.logger,q=u.requestId,v=u.method,g=u.url,w=u.headers,m=void 0===w?{}:w,b=u.data,E=void 0===b?"":b,H=u.uploadProgressHandler,S=!1,x=new XMLHttpRequest;for(var y in x.open(v,g),m)x.setRequestHeader(y,m[y]);H&&x.upload.addEventListener("progress",(function(e){e.lengthComputable?H(q,e.loaded,e.total):h.debug("Progress computing failed: `Content-Length` header is not given.")})),x.onabort=function(){f(r.requestCanceled)},x.onerror=function(e){f(r.networkError)},x.onreadystatechange=function(){if(x.readyState===XMLHttpRequest.DONE&&!S)if(0===x.status||x.status>=200&&x.status<400)try{var e=JSON.parse(x.responseText);p(new t(i,e))}catch(u){f(r.networkError)}else try{var d=JSON.parse(x.responseText);if(d){var u=new r(d);if(u.isSessionExpiredError){if(l.dispatch(new s({reason:u.code})),!(x instanceof n)){var c=new a;return l.dispatch(new o({request:x,deferred:c,error:u})),c.promise}}else u.isSessionInvalidatedError&&l.dispatch(new s({reason:u.code}));f(u)}else f(r.requestFailed)}catch(u){f(r.requestFailed)}},l.on((function(e){e instanceof d&&(e.requestId&&e.requestId!==q||(S=!0,x.abort()))})),x.send(E)}else f(r.xmlHttpRequestNotSupported)}))};export{i as xmlHttpRequest};
