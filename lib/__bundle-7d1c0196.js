import{V as e,t,g as s,Z as r,bD as a,aF as n,bE as o,aD as d}from"./__bundle-7f6b90ff.js";var i=function(i,u){return new Promise((function(f,c){if("undefined"!=typeof XMLHttpRequest){var p=e.of(i),l=p.dispatcher,g=p.logger,h=u.requestId,m=u.method,q=u.url,v=u.headers,w=void 0===v?{}:v,b=u.data,E=void 0===b?"":b,y=u.uploadProgressHandler,H=!1,S=new XMLHttpRequest;S.open(m,q),Object.keys(w).forEach((function(e){S.setRequestHeader(e,w[e])})),y&&S.upload.addEventListener("progress",(function(e){e.lengthComputable?y(h,e.loaded,e.total):g.debug("Progress computing failed: `Content-Length` header is not given.")})),S.onabort=function(){c(t.requestCanceled)},S.onerror=function(e){c(t.networkError)},S.onreadystatechange=function(){if(S.readyState===XMLHttpRequest.DONE&&!H)if(0===S.status||S.status>=200&&S.status<400)try{var e=JSON.parse(S.responseText);f(new s(i,e))}catch(u){c(t.networkError)}else try{var d=JSON.parse(S.responseText);if(d){var u=new t(d);if(u.isSessionExpiredError){if(l.dispatch(new r({reason:u.code,message:u.message})),!(S instanceof a)){var p=new n;return l.dispatch(new o({request:S,deferred:p,error:u})),p.promise}}else u.isSessionInvalidatedError&&l.dispatch(new r({reason:u.code,message:u.message}));c(u)}else c(t.requestFailed)}catch(u){c(t.requestFailed)}},l.on((function(e){e instanceof d&&(e.requestId&&e.requestId!==h||(H=!0,S.abort()))})),S.send(E)}else c(t.xmlHttpRequestNotSupported)}))};export{i as xmlHttpRequest};
