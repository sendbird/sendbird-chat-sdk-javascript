import{V as e,s as t,h as s,M as r,br as a,ax as n,bs as o,av as d}from"./__bundle-c03282ec.js";var i=function(i,u){return new Promise((function(c,p){if("undefined"!=typeof XMLHttpRequest){var f=e.of(i),l=f.dispatcher,g=f.logger,h=u.requestId,m=u.method,q=u.url,v=u.headers,w=void 0===v?{}:v,b=u.data,E=void 0===b?"":b,x=u.uploadProgressHandler,y=!1,H=new XMLHttpRequest;H.open(m,q),Object.keys(w).forEach((function(e){H.setRequestHeader(e,w[e])})),x&&H.upload.addEventListener("progress",(function(e){e.lengthComputable?x(h,e.loaded,e.total):g.debug("Progress computing failed: `Content-Length` header is not given.")})),H.onabort=function(){p(t.requestCanceled)},H.onerror=function(e){p(t.networkError)},H.onreadystatechange=function(){if(H.readyState===XMLHttpRequest.DONE&&!y)if(0===H.status||H.status>=200&&H.status<400)try{var e=JSON.parse(H.responseText);c(new s(i,e))}catch(u){p(t.networkError)}else try{var d=JSON.parse(H.responseText);if(d){var u=new t(d);if(u.isSessionExpiredError){if(l.dispatch(new r({reason:u.code,message:u.message})),!(H instanceof a)){var f=new n;return l.dispatch(new o({request:H,deferred:f,error:u})),f.promise}}else u.isSessionInvalidatedError&&l.dispatch(new r({reason:u.code,message:u.message}));p(u)}else p(t.requestFailed)}catch(u){p(t.requestFailed)}},l.on((function(e){e instanceof d&&(e.requestId&&e.requestId!==h||(y=!0,H.abort()))})),H.send(E)}else p(t.xmlHttpRequestNotSupported)}))};export{i as xmlHttpRequest};
