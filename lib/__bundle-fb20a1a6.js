import{j as t,c as e,aU as E,a as n,$ as o,e as i,u as l,ak as s,an as a,a2 as r,C as _,aM as u,A as N,aI as c,f as A,g as d,aq as T,G as h,_ as p,b as S,F as C,t as D,V as L,U as v}from"./__bundle-26b86bf8.js";var V;!function(t){t.UNKNOWN="UNKNOWN",t.EVENT_CHANNEL_CREATED="EVENT_CHANNEL_CREATED",t.EVENT_CHANNEL_UPDATED="EVENT_CHANNEL_UPDATED",t.EVENT_CHANNEL_DELETED="EVENT_CHANNEL_DELETED",t.EVENT_CHANNEL_READ="EVENT_CHANNEL_READ",t.EVENT_CHANNEL_UNREAD="EVENT_CHANNEL_UNREAD",t.EVENT_CHANNEL_DELIVERED="EVENT_CHANNEL_DELIVERED",t.EVENT_CHANNEL_INVITED="EVENT_CHANNEL_INVITED",t.EVENT_CHANNEL_JOINED="EVENT_CHANNEL_JOINED",t.EVENT_CHANNEL_LEFT="EVENT_CHANNEL_LEFT",t.EVENT_CHANNEL_ACCEPTED_INVITE="EVENT_CHANNEL_ACCEPTED_INVITE",t.EVENT_CHANNEL_DECLINED_INVITE="EVENT_CHANNEL_DECLINED_INVITE",t.EVENT_CHANNEL_OPERATOR_UPDATED="EVENT_CHANNEL_OPERATOR_UPDATED",t.EVENT_CHANNEL_BANNED="EVENT_CHANNEL_BANNED",t.EVENT_CHANNEL_UNBANNED="EVENT_CHANNEL_UNBANNED",t.EVENT_CHANNEL_MUTED="EVENT_CHANNEL_MUTED",t.EVENT_CHANNEL_UNMUTED="EVENT_CHANNEL_UNMUTED",t.EVENT_CHANNEL_FROZEN="EVENT_CHANNEL_FROZEN",t.EVENT_CHANNEL_UNFROZEN="EVENT_CHANNEL_UNFROZEN",t.EVENT_CHANNEL_HIDDEN="EVENT_CHANNEL_HIDDEN",t.EVENT_CHANNEL_UNHIDDEN="EVENT_CHANNEL_UNHIDDEN",t.EVENT_CHANNEL_RESET_HISTORY="EVENT_CHANNEL_RESET_HISTORY",t.EVENT_CHANNEL_TYPING_STATUS_UPDATE="EVENT_CHANNEL_TYPING_STATUS_UPDATE",t.EVENT_CHANNEL_MEMBER_COUNT_UPDATED="EVENT_CHANNEL_MEMBER_COUNT_UPDATED",t.EVENT_CHANNEL_METADATA_CREATED="EVENT_CHANNEL_METADATA_CREATED",t.EVENT_CHANNEL_METADATA_UPDATED="EVENT_CHANNEL_METADATA_UPDATED",t.EVENT_CHANNEL_METADATA_DELETED="EVENT_CHANNEL_METADATA_DELETED",t.EVENT_CHANNEL_METACOUNTER_CREATED="EVENT_CHANNEL_METACOUNTER_CREATED",t.EVENT_CHANNEL_METACOUNTER_UPDATED="EVENT_CHANNEL_METACOUNTER_UPDATED",t.EVENT_CHANNEL_METACOUNTER_DELETED="EVENT_CHANNEL_METACOUNTER_DELETED",t.EVENT_MESSAGE_SENT="EVENT_MESSAGE_SENT",t.EVENT_MESSAGE_RECEIVED="EVENT_MESSAGE_RECEIVED",t.EVENT_MESSAGE_UPDATED="EVENT_MESSAGE_UPDATED",t.EVENT_PINNED_MESSAGE_UPDATED="EVENT_PINNED_MESSAGE_UPDATED",t.REQUEST_CHANNEL="REQUEST_CHANNEL",t.REQUEST_CHANNEL_CHANGELOGS="REQUEST_CHANNEL_CHANGELOGS",t.REFRESH_CHANNEL="REFRESH_CHANNEL",t.CHANNEL_LASTACCESSEDAT_UPDATED="CHANNEL_LASTACCESSEDAT_UPDATED",t.SYNC_CHANNEL_BACKGROUND="SYNC_CHANNEL_BACKGROUND",t.SYNC_CHANNEL_CHANGELOGS="SYNC_CHANNEL_CHANGELOGS",t.EVENT_MESSAGE_SENT_SUCCESS="EVENT_MESSAGE_SENT_SUCCESS",t.EVENT_MESSAGE_SENT_FAILED="EVENT_MESSAGE_SENT_FAILED",t.EVENT_MESSAGE_SENT_PENDING="EVENT_MESSAGE_SENT_PENDING",t.EVENT_MESSAGE_DELETED="EVENT_MESSAGE_DELETED",t.EVENT_MESSAGE_FEEDBACK_ADDED="EVENT_MESSAGE_FEEDBACK_ADDED",t.EVENT_MESSAGE_FEEDBACK_UPDATED="EVENT_MESSAGE_FEEDBACK_UPDATED",t.EVENT_MESSAGE_FEEDBACK_DELETED="EVENT_MESSAGE_FEEDBACK_DELETED",t.EVENT_MESSAGE_READ="EVENT_MESSAGE_READ",t.EVENT_MESSAGE_DELIVERED="EVENT_MESSAGE_DELIVERED",t.EVENT_MESSAGE_REACTION_UPDATED="EVENT_MESSAGE_REACTION_UPDATED",t.EVENT_MESSAGE_THREADINFO_UPDATED="EVENT_MESSAGE_THREADINFO_UPDATED",t.EVENT_MESSAGE_OFFSET_UPDATED="EVENT_MESSAGE_OFFSET_UPDATED",t.REQUEST_MESSAGE="REQUEST_MESSAGE",t.EVENT_THREAD_INFO_UPDATED="EVENT_THREADINFO_UPDATED",t.EVENT_POLL_UPDATED="EVENT_POLL_UPDATED",t.EVENT_POLL_VOTED="EVENT_POLL_VOTED",t.SYNC_POLL_CHANGELOGS="SYNC_POLL_CHANGELOGS",t.EVENT_CHANNEL_CSAT_SUBMITTED="EVENT_CHANNEL_CSAT_SUBMITTED",t.EVENT_CHANNEL_CONVERSATION_HANDEDOFF="EVENT_CHANNEL_CONVERSATION_HANDEDOFF",t.REQUEST_RESEND_MESSAGE="REQUEST_RESEND_MESSAGE",t.REQUEST_THREADED_MESSAGE="REQUEST_THREADED_MESSAGE",t.REQUEST_MESSAGE_CHANGELOGS="REQUEST_MESSAGE_CHANGELOGS",t.SYNC_MESSAGE_FILL="SYNC_MESSAGE_FILL",t.SYNC_MESSAGE_BACKGROUND="SYNC_MESSAGE_BACKGROUND",t.SYNC_MESSAGE_CHANGELOGS="SYNC_MESSAGE_CHANGELOGS",t.LOCAL_MESSAGE_PENDING_CREATED="LOCAL_MESSAGE_PENDING_CREATED",t.LOCAL_MESSAGE_FAILED="LOCAL_MESSAGE_FAILED",t.LOCAL_MESSAGE_CANCELED="LOCAL_MESSAGE_CANCELED",t.LOCAL_MESSAGE_RESEND_STARTED="LOCAL_MESSAGE_RESEND_STARTED"}(V||(V={}));var f,U=t({},V),I=function(t){return t.startsWith("EVENT_")||t.startsWith("LOCAL_MESSAGE_")||t===V.SYNC_MESSAGE_FILL||t===V.SYNC_MESSAGE_CHANGELOGS||t===V.SYNC_POLL_CHANGELOGS},H=function(t){function E(e){var E=e.messages,n=e.source,o=e.isWebSocketEventComing,i=void 0!==o&&o,l=t.call(this)||this;return l.messages=E,l.source=n,l.isWebSocketEventComing=i,l}return e(E,t),E}(E),G=function(t){function E(e){var E=e.messageIds,n=e.source,o=e.isWebSocketEventComing,i=void 0!==o&&o,l=t.call(this)||this;return l.messageIds=E,l.source=n,l.isWebSocketEventComing=i,l}return e(E,t),E}(E),O=function(t){function E(e){var E=e.messageDeletionTimestamp,n=e.channelUrl,o=e.source,i=t.call(this)||this;return i.messageDeletionTimestamp=E,i.channelUrl=n,i.source=o,i}return e(E,t),E}(E),M=function(t){function E(e){var E=e.event,n=e.source,o=e.isWebSocketEventComing,i=void 0!==o&&o,l=t.call(this)||this;return l.event=E,l.source=n,l.isWebSocketEventComing=i,l}return e(E,t),E}(E),m=function(t){function E(e){var E=e.event,n=e.source,o=e.isWebSocketEventComing,i=void 0!==o&&o,l=t.call(this)||this;return l.event=E,l.source=n,l.isWebSocketEventComing=i,l}return e(E,t),E}(E),R=function(t){function E(e){var E=e.reqId,n=e.source,o=t.call(this)||this;return o.reqId=E,o.source=n,o}return e(E,t),E}(E),P=function(t){function E(e){var E=e.polls,n=e.source,o=t.call(this)||this;return o.polls=E,o.source=n,o}return e(E,t),E}(E),g=function(t){function E(e){var E=e.event,n=e.source,o=t.call(this)||this;return o.event=E,o.source=n,o}return e(E,t),E}(E),y=function(t){function E(e){var E=e.event,n=e.source,o=t.call(this)||this;return o.event=E,o.source=n,o}return e(E,t),E}(E);!function(t){t.OPEN="open",t.CLOSED="closed"}(f||(f={}));var w="removed",F=function(t){switch(t){case"open":return f.OPEN;case"closed":return f.CLOSED;default:return null}},b=function(t){return!t||!!t.text&&n("string",t.text)},k=function(E){function n(t,e){var n,o,i,l,s,a,r,_=this;return(_=E.call(this,t)||this).pollId=0,_.id=0,_.text=null,_.voteCount=0,_.createdBy=null,_.createdAt=0,_.updatedAt=0,_._lastVotedAt=0,_.pollId=null!==(n=e.poll_id)&&void 0!==n?n:0,_.id=null!==(o=e.id)&&void 0!==o?o:0,_.text=null!==(i=e.text)&&void 0!==i?i:null,_.voteCount=null!==(l=e.vote_count)&&void 0!==l?l:0,_.createdBy=null!==(s=e.created_by)&&void 0!==s?s:null,_.createdAt=null!==(a=e.created_at)&&void 0!==a?a:0,_.updatedAt=null!==(r=e.updated_at)&&void 0!==r?r:0,_}return e(n,E),n.payloadify=function(e){return i(l(t(t({},E.payloadify.call(this,e)),{vote_count:e.voteCount,poll_id:e.pollId,text:e.text,created_at:e.createdAt,id:e.id,created_by:e.createdBy,updated_at:e.updatedAt})))},n}(s),B=function(E){function n(t,e){var n,o,i,l,s,a,r,_,u,N,c,A,d,T=this;return(T=E.call(this,t)||this).id=0,T.title=null,T.createdAt=0,T.updatedAt=0,T.closeAt=-1,T.status=f.CLOSED,T.messageId=0,T.data=null,T.voterCount=-1,T.options=[],T.createdBy=null,T.allowUserSuggestion=!1,T.allowMultipleVotes=!1,T.votedPollOptionIds=[],T.id=null!==(n=e.id)&&void 0!==n?n:0,T.title=null!==(o=e.title)&&void 0!==o?o:null,T.createdAt=null!==(i=e.created_at)&&void 0!==i?i:0,T.updatedAt=null!==(l=e.updated_at)&&void 0!==l?l:0,T.closeAt=null!==(s=e.close_at)&&void 0!==s?s:-1,T.status=null!==(a=F(e.status))&&void 0!==a?a:f.CLOSED,T.messageId=null!==(r=e.message_id)&&void 0!==r?r:0,T.data=null!==(_=e.data)&&void 0!==_?_:null,T.voterCount=null!==(u=e.voter_count)&&void 0!==u?u:-1,T.options=e.options?e.options.map((function(t){return new k(T._iid,t)})):[],T.createdBy=null!==(N=e.created_by)&&void 0!==N?N:null,T.allowUserSuggestion=null!==(c=e.allow_user_suggestion)&&void 0!==c&&c,T.allowMultipleVotes=null!==(A=e.allow_multiple_votes)&&void 0!==A&&A,T.votedPollOptionIds=null!==(d=e.voted_option_ids)&&void 0!==d?d:[],T}return e(n,E),n.prototype._applyPollUpdatePayload=function(t){var e,E,n,o,i,l,s,a,r=this;this.title=null!==(e=t.title)&&void 0!==e?e:this.title,this.updatedAt=null!==(E=t.updated_at)&&void 0!==E?E:this.updatedAt,this.closeAt=null!==(n=t.close_at)&&void 0!==n?n:this.closeAt,this.status=null!==(o=F(t.status))&&void 0!==o?o:this.status,this.data=null!==(i=t.data)&&void 0!==i?i:this.data,this.voterCount=null!==(l=t.voter_count)&&void 0!==l?l:this.voterCount,t.options&&(this.options=t.options.map((function(t){return new k(r._iid,t)})),this.votedPollOptionIds=t.options.filter((function(t){return t.vote_count>0})).map((function(t){return t.id}))),this.allowUserSuggestion=null!==(s=t.allow_user_suggestion)&&void 0!==s?s:this.allowUserSuggestion,this.allowMultipleVotes=null!==(a=t.allow_multiple_votes)&&void 0!==a?a:this.allowMultipleVotes},n.payloadify=function(e){return i(l(t(t({},E.payloadify.call(this,e)),{id:e.id,title:e.title,created_at:e.createdAt,updated_at:e.updatedAt,close_at:e.closeAt,status:e.status,message_id:e.messageId,data:e.data,voter_count:e.voterCount,options:e.options.map((function(t){return k.payloadify(t)})),created_by:e.createdBy,allow_user_suggestion:e.allowUserSuggestion,allow_multiple_votes:e.allowMultipleVotes,voted_option_ids:e.votedPollOptionIds})))},n.prototype.applyPollUpdateEvent=function(t){var e=t._payload.poll;return!(!e||this.id!==e.id||e.updated_at<this.updatedAt)&&(this._applyPollUpdatePayload(e),!0)},n.prototype.applyPollVoteEvent=function(t){if(this.id!==t.pollId)return!1;var e=this.options,E=e.map((function(t){return t.id})),n=t._payload,o=Math.floor(n.ts/1e3);return n.updated_vote_counts.forEach((function(t){var n=E.indexOf(t.option_id);if(n>-1){var i=e[n];o>=i._lastVotedAt&&(i.voteCount=t.vote_count,i._lastVotedAt=o)}})),n.req_id&&n.voted_option_ids&&(this.votedPollOptionIds=n.voted_option_ids),"number"==typeof n.voter_count&&(this.voterCount=n.voter_count),!0},n.prototype.serialize=function(){return a(this)},n}(s),x=function(t){function E(e,E,n,o){var i=t.call(this,e,o)||this;return i.channelUrl=E,i.channelType=n,i}return e(E,t),E.prototype._validate=function(){return t.prototype._validate.call(this)&&n("string",this.channelUrl)&&r(_,this.channelType)},E}(u),Q=function(t){this.pollId=0,this.messageId=0,this.pollId=t.poll_id,this.messageId=t.message_id,this._payload=t},Y=function(t){function E(e){var E=e.title,n=e.optionTexts,o=e.data,i=e.allowUserSuggestion,l=e.allowMultipleVotes,s=e.closeAt,a=t.call(this)||this;return a.method=N.POST,a.path=c,a.params={title:E,options:n,data:o,allow_user_suggestion:i,allow_multiple_votes:l,close_at:s},a}return e(E,t),E}(A),q=function(t){function E(e,E){var n=t.call(this,e,E)||this;return n.poll=new B(e,E),n}return e(E,t),E}(d),K=function(t){function E(e){var E=e.channelUrl,n=e.channelType,o=e.pollId,i=t.call(this)||this;return i.method=N.GET,i.path="".concat(c,"/").concat(encodeURIComponent(o)),i.params={channel_url:E,channel_type:n},i}return e(E,t),E}(A),W=function(t){function E(e,E){var n=t.call(this,e,E)||this;return n.poll=new B(e,E),n}return e(E,t),E}(d),Z=function(t){function E(e){var E=e.channelUrl,n=e.channelType,o=e.pollId,i=e.pollOptionId,l=t.call(this)||this;return l.method=N.GET,l.path="".concat(c,"/").concat(encodeURIComponent(o),"/options/").concat(encodeURIComponent(i)),l.params={channel_url:E,channel_type:n},l}return e(E,t),E}(A),j=function(t){function E(e,E){var n=t.call(this,e,E)||this;return n.pollOption=new k(e,E),n}return e(E,t),E}(d),z=function(t){function E(e){var E=e.channelType,n=e.channelUrl,o=e.timestamp,l=e.token,s=t.call(this)||this;return s.method=N.GET,s.path="".concat(T(E),"/").concat(encodeURIComponent(n),"/polls/changelogs"),s.params=i({change_ts:o,token:l}),s}return e(E,t),E}(A),J=function(t){function E(e,E){var n=t.call(this,e,E)||this;return n.updatedPolls=E.updated.map((function(t){return function(t,e){return new B(t,e)}(e,t)})),n.deletedPollIds=E.deleted.map((function(t){return t})),n.hasMore=E.has_more,n.nextToken=E.next,n}return e(E,t),E}(d),$={title:"",optionTexts:[],data:void 0,allowUserSuggestion:void 0,allowMultipleVotes:void 0,closeAt:-1},X=function(t){return n("string",t.title)&&(e=t.optionTexts,o("string",e)&&e.every((function(t){return""!==t.trim()})))&&b(t.data)&&n("boolean",t.allowUserSuggestion,!0)&&n("boolean",t.allowMultipleVotes,!0)&&n("number",t.closeAt,!0);var e},tt={channelUrl:"",channelType:_.BASE,pollId:0,pollOptionId:0},et=function(t){return n("string",t.channelUrl)&&""!==t.channelUrl&&r(_,t.channelType)&&n("number",t.pollId)&&t.pollId>0&&n("number",t.pollOptionId)&&t.pollOptionId>0},Et={channelUrl:"",channelType:_.BASE,pollId:0},nt=function(t){return n("string",t.channelUrl)&&""!==t.channelUrl&&r(_,t.channelType)&&n("number",t.pollId)},ot={},it=function(){function e(t,e){var E=e.sdkState,n=e.dispatcher,o=e.sessionManager,i=e.requestQueue,l=e.logger;this._iid=t,this._sdkState=E,this._sessionManager=o,this._requestQueue=i,this._dispatcher=n,this._logger=l,ot[t]=this}return e.of=function(t){return ot[t]},e.prototype.buildPollFromSerializedData=function(t){var e=h(t);return new B(this._iid,B.payloadify(e))},e.prototype.get=function(e){return p(this,void 0,void 0,(function(){var E,n;return S(this,(function(o){switch(o.label){case 0:return C(nt(e)).throw(D.invalidParameters),E=new K(t({},e)),[4,this._requestQueue.send(E)];case 1:return n=o.sent(),[2,n.as(W).poll]}}))}))},e.prototype.create=function(e){return p(this,void 0,void 0,(function(){var E,n;return S(this,(function(o){switch(o.label){case 0:return C(X(e)).throw(D.invalidParameters),E=new Y(t({},e)),[4,this._requestQueue.send(E)];case 1:return n=o.sent(),[2,n.as(q).poll]}}))}))},e.prototype.getOption=function(e){return p(this,void 0,void 0,(function(){var E,n;return S(this,(function(o){switch(o.label){case 0:return C(et(e)).throw(D.invalidParameters),E=new Z(t({},e)),[4,this._requestQueue.send(E)];case 1:return n=o.sent(),[2,n.as(j).pollOption]}}))}))},e.prototype.getPollChangeLogs=function(t,e,E,n){return void 0===n&&(n=V.SYNC_POLL_CHANGELOGS),p(this,void 0,void 0,(function(){var o,i,s,a,r,_,u;return S(this,(function(N){switch(N.label){case 0:return o=new z(l({channelType:e,channelUrl:t,timestamp:"number"==typeof E?E:null,token:"string"==typeof E?E:null})),[4,this._requestQueue.send(o)];case 1:return i=N.sent(),s=i.as(J),a=s.updatedPolls,r=s.deletedPollIds,_=s.hasMore,u=s.nextToken,a.length>0&&this._dispatcher.dispatch(new P({polls:a,source:n})),[2,{updatedPolls:a,deletedPollIds:r,hasMore:_,token:u}]}}))}))},e}(),lt=function(t){function E(e){var E=e.channelUrl,n=e.channelType,o=e.token,i=e.limit,l=t.call(this)||this;return l.method=N.GET,l.path=c,l.params={channel_url:E,channel_type:n,token:o,limit:i},l}return e(E,t),E}(A),st=function(t){function E(e,E){var n,o=this;return(o=t.call(this,e,E)||this).polls=(null!==(n=E.polls)&&void 0!==n?n:[]).map((function(t){return new B(e,t)})),o.token=E.next,o}return e(E,t),E}(d),at=function(E){function n(t,e){return E.call(this,t,e.channelUrl,e.channelType,e)||this}return e(n,E),n.prototype.next=function(){return p(this,void 0,void 0,(function(){var e,E,n,o,i,l;return S(this,(function(s){switch(s.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=L.of(this._iid).requestQueue,E=new lt(t(t({},this),{token:this._token})),[4,e.send(E)]):[3,2]:[3,5];case 1:return n=s.sent(),o=n.as(st),i=o.polls,l=o.token,this._token=l,this._hasNext=!!l,this._isLoading=!1,[2,i];case 2:return[2,[]];case 3:throw D.queryInProgress;case 4:return[3,6];case 5:throw D.invalidParameters;case 6:return[2]}}))}))},n}(x),rt=function(t){function E(e){var E=e.channelUrl,n=e.channelType,o=e.pollId,i=e.pollOptionId,l=e.token,s=e.limit,a=t.call(this)||this;return a.method=N.GET,a.path="".concat(c,"/").concat(encodeURIComponent(o),"/options/").concat(encodeURIComponent(i),"/voters"),a.params={channel_url:E,channel_type:n,token:l,limit:s},a}return e(E,t),E}(A),_t=function(t){function E(e,E){var n,o=this;return(o=t.call(this,e,E)||this).voters=(null!==(n=E.voters)&&void 0!==n?n:[]).map((function(t){return new v(e,t)})),o.token=E.next,o}return e(E,t),E}(d),ut=function(E){function o(t,e){var n=E.call(this,t,e.channelUrl,e.channelType,e)||this;return n.pollId=e.pollId,n.pollOptionId=e.pollOptionId,n}return e(o,E),o.prototype._validate=function(){return E.prototype._validate.call(this)&&n("number",this.pollId)&&n("number",this.pollOptionId)},o.prototype.next=function(){return p(this,void 0,void 0,(function(){var e,E,n,o,i,l;return S(this,(function(s){switch(s.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=L.of(this._iid).requestQueue,E=new rt(t(t({},this),{pollId:this.pollId,pollOptionId:this.pollOptionId,token:this._token})),[4,e.send(E)]):[3,2]:[3,5];case 1:return n=s.sent(),o=n.as(_t),i=o.voters,l=o.token,this._token=l,this._hasNext=!!l,this._isLoading=!1,[2,i];case 2:return[2,[]];case 3:throw D.queryInProgress;case 4:return[3,6];case 5:throw D.invalidParameters;case 6:return[2]}}))}))},o}(x);export{V as C,H as M,at as P,M as R,m as T,R as U,ut as a,B as b,x as c,Q as d,y as e,it as f,O as g,g as h,P as i,G as j,$ as k,X as l,Et as m,nt as n,tt as o,et as p,k as q,f as r,U as s,w as t,I as u,b as v,F as w};
